"use strict";angular.module("app").controller("examineCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){return new Promise(function(n,o){a.server().approvalformConditions({type:e||1},function(e){e.result?(t.dataCheckbox=e.data.nodeTypes,t.dataCheckbox.forEach(function(e,a){t.dataCheckbox[a].state=!1}),n(e.data),t.$apply()):alert(e.message)})}),Promise}function r(e){t.firstSelectAll=!1,t.allzhengfalg=!0,t.examineName="审批列表",t.examineLength=0,t.conf.counts=0,t.pageflag=!1,a.server().approvallist(e,function(e){if(e.result){if(e.data.rows){var a=0;t.propertys=e.data.rows,t.examineLength=e.data.total||0,t.propertys.forEach(function(e,n){t.propertys[n].firstChildstate=!1,1!==t.propertys[n].is_done&&a++}),t.propertys.length===a?t.firstParentState=!0:t.firstParentState=!1,t.pageflag=!0,t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$broadcast("categoryLoaded"),t.$apply()}}else alert(e.message)})}function l(e,a){if(t.approveId=[],t.firstSelectAll)e.forEach(function(a,n){"1"==e[n].is_done&&t.approveId.push(e[n].id)});else if(e.forEach(function(a,n){e[n].firstChildstate&&t.approveId.push(e[n].id)}),t.approveId.length<=0)return void alert("请选择审批列表");t.clickflag&&c(t.approveId,a)}function c(e,n){t.clickflag=!1,o.timeouts(t.clickflag,3e3,function(e){t.clickflag=e}),1===n?a.server().zjapprovalformfincialThroghdo({approvalId:e.join(",")||"",userId:y,remakers:"",type:1,fincialIds:""},function(e){e.result?(alert(e.message,function(){d(t.param)}),t.$apply()):alert(e.message)}):a.server().zjapprovalformthroghdo({approvalFormId:e.join(",")||"",currentUser:y,examineRemarks:""},function(e){e.result?(alert(e.message,function(){0===n?r(t.param):2===n?p(t.param):3===n&&u(t.param)}),t.$apply()):alert(e.message)})}function d(e){t.firstSelectAll=!1,t.allzhengfalg=!1,t.examineName="支付审批",t.examineLength=0,t.conf.counts=0,t.pageflag=!1,a.server().zjapprovalformfincialColsListdo(e,function(e){if(e.result){if(e.data.rows){t.waterRows=e.data.rows,t.examineLength=e.data.total||0;var a=0;t.waterRows.forEach(function(e,n){t.waterRows[n].examineSeris="第"+t.waterRows[n].examineSeris+"阶段",t.waterRows[n].firstChildstate=!1,1!==t.waterRows[n].is_done&&a++}),t.waterRows.length===a?t.firstParentState=!0:t.firstParentState=!1,t.pageflag=!0,t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$broadcast("categoryLoaded"),t.$apply()}}else alert(e.message)})}function p(e){t.firstSelectAll=!1,t.allzhengfalg=!0,t.examineName="规则审批",t.examineLength=0,t.conf.counts=0,t.pageflag=!1,a.server().zjapprovalformfindRulesListdo(e,function(e){if(e.result){if(e.data.rows){t.threeList=e.data.rows;var a=0;t.examineLength=e.data.total||0,t.threeList.forEach(function(e,n){t.threeList[n].examineSeris="第"+t.threeList[n].examineSeris+"阶段",t.threeList[n].firstChildstate=!1,1!==t.threeList[n].is_done&&a++}),t.threeList.length===a?t.firstParentState=!0:t.firstParentState=!1,t.pageflag=!0,t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$broadcast("categoryLoaded"),t.$apply()}}else alert(e.message)})}function u(e){t.firstSelectAll=!1,t.allzhengfalg=!0,t.examineName="项目审核",t.examineLength=0,t.conf.counts=0,t.pageflag=!1,a.server().zjapprovalformfindProjectdo(e,function(e){if(e.result){if(e.data.rows){var a=0;t.fourList=e.data.rows,t.examineLength=e.data.total||0,t.fourList.forEach(function(e,n){t.fourList[n].examineSeris="第"+t.fourList[n].examineSeris+"阶段",t.fourList[n].firstChildstate=!1,1!==t.fourList[n].is_done&&a++}),t.fourList.length===a?t.firstParentState=!0:t.firstParentState=!1,t.pageflag=!0,t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$broadcast("categoryLoaded"),t.$apply()}}else alert(e.message)})}function m(e,a,n,o){laydate.render({elem:"."+e,type:"date",format:"yyyy-MM-dd",show:!0,closeStop:"."+a,done:function(e){t.beginTime=e,n&&o(e)}})}function f(e,t,a,n){laydate.render({elem:"."+e,type:"date",format:"yyyy-MM-dd",show:!0,closeStop:"."+t,done:function(e){n(e)}})}var g=setInterval(function(){$(".l-nav>li").length>0&&($(".l-nav>li").eq(6).addClass("cur"),clearInterval(g))},10);t.projectId=n.params.projectid;var y=a.server().userId;t.no="-",t.clickflag=!0,t.selectAll=!0,t.isActive=!0,t.bigTab=[{tab:!0},{tab:!1},{tab:!1},{tab:!1}],t.dayCount="",t.selected=[],t.mode="3",t.beginTime="",t.endTime="",t.PullUpShow=!0,t.PullUpText="收起",t.pullUp=function(){t.PullUpShow?(t.PullUpShow=!1,t.PullUpText="展开"):(t.PullUpShow=!0,t.PullUpText="收起")},t.conf={total:0,currentPage:i.paramsVal1&&i.paramstype?i.paramsVal1.pageNo:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.param={userId:y,projectId:t.projectId,type:t.selected.join(",")||"",mode:t.mode||"",dateOne:t.beginTime||"",dateTwo:t.endTime||"",other:t.dayCount||"",pageNo:t.conf.currentPage||1,pageSize:t.conf.itemPageLimit||10},Promise.all([function(){return new Promise(function(e,n){a.server().projectnamesel({projectId:t.projectId},function(a){!0===a.result?(t.projectname=a.data.projectName,t.number=a.data.number,t.$apply(),e(a.data)):alert(a.message)})}),Promise}(),s(1)]).then(function(e){return e},function(e){return e}),t.$watch("conf.currentPage + conf.itemPageLimit",function(e){i.paramsVal1&&i.paramstype?(t.param=i.paramsVal1,t.bigTab=[{tab:!1},{tab:!1},{tab:!1},{tab:!1}],t.bigTab[Number(i.paramstype)-1].tab=!0,t.bigTab[0].tab&&(r(t.param),i.paramsVal1=""),t.bigTab[1].tab&&(d(t.param),i.paramsVal1=""),t.bigTab[2].tab&&(p(t.param),i.paramsVal1=""),t.bigTab[3].tab&&(u(t.param),i.paramsVal1="")):(t.param.pageNo=t.conf.currentPage,t.bigTab[0].tab&&r(t.param),t.bigTab[1].tab&&d(t.param),t.bigTab[2].tab&&p(t.param),t.bigTab[3].tab&&u(t.param))}),t.firstParentSelectionAll=function(e,a){if(e)a.forEach(function(e,t){"1"==a[t].is_done&&(a[t].firstChildstate=!0)});else{var n=0;a.forEach(function(e,t){"1"==a[t].is_done&&!1===a[t].firstChildstate&&(n=1)}),1===n&&(t.firstSelectAll=!0)}},t.firstchildSelection=function(e,a,n){if(e){var o=0;n.forEach(function(e,t){"1"==n[t].is_done&&!1===n[t].firstChildstate&&(o=1)}),t.firstSelectAll=0===o}else t.firstSelectAll=!1},t.Allexamine=function(){t.bigTab[0].tab?l(t.propertys,0):t.bigTab[1].tab?l(t.waterRows,1):t.bigTab[2].tab?l(t.threeList,2):t.bigTab[3].tab&&l(t.fourList,3)},t.updateSelection=function(e,a,n){if(e.target.checked)t.selected.push(a);else{var o=t.selected.indexOf(a);t.selected.splice(o,1)}0===t.selected.length?t.selectAll=!0:t.selectAll=!1,t.param.type=t.selected.join(","),t.bigTab[0].tab&&r(t.param),t.bigTab[1].tab&&d(t.param),t.bigTab[2].tab&&p(t.param),t.bigTab[3].tab&&u(t.param)},t.checkobxAll=function(e,a){if(!1===e&&0===t.selected.length&&(t.selectAll=!0),!0===e){t.selected=[];for(var n=0;n<t.dataCheckbox.length;n++)t.dataCheckbox[n].state=!1}t.param.type=t.selected.join(","),t.bigTab[0].tab&&r(t.param),t.bigTab[1].tab&&d(t.param),t.bigTab[2].tab&&p(t.param),t.bigTab[3].tab&&u(t.param)},t.radios=function(e){t.param.mode=e,t.bigTab[0].tab&&r(t.param),t.bigTab[1].tab&&d(t.param),t.bigTab[2].tab&&p(t.param),t.bigTab[3].tab&&u(t.param)},t.isActive=!1,t.isActive2=!1,t.monthData=function(e){$(".childData1").val(""),$(".childData2").val(""),1==e?(t.isActive=!t.isActive,t.isActive?(t.isActive2=!1,t.dayCount=1):t.dayCount=""):(t.isActive2=!t.isActive2,t.isActive2?(t.isActive=!1,t.dayCount=2):t.dayCount=""),t.param.other=t.dayCount,t.param.dateOne="",t.param.dateTwo="",t.bigTab[0].tab&&r(t.param),t.bigTab[1].tab&&d(t.param),t.bigTab[2].tab&&p(t.param),t.bigTab[3].tab&&u(t.param)},t.alertData=function(e,a,n){1===n?m(e,a):t.beginTime?f(e,a,t.beginTime,function(e){e?(t.beginTime=t.beginTime.toString(),t.endTime=e.toString(),t.param.dateOne=t.beginTime,t.param.dateTwo=t.endTime,t.param.other="",t.bigTab[0].tab&&r(t.param),t.bigTab[1].tab&&d(t.param),t.bigTab[2].tab&&p(t.param),t.bigTab[3].tab&&u(t.param)):alert("请选择结束时间")}):alert("请选择开始时间")},t.wholeApproval=function(){t.selectAll=!0,t.selected=[],t.mode=3,t.dayCount="",t.beginTime="",t.endTime="",t.conf.currentPage=1,t.bigTab=[{tab:!0},{tab:!1},{tab:!1},{tab:!1}],r(t.param),s(1)},t.waterApproval=function(){t.selectAll=!0,t.selected=[],t.mode=3,t.dayCount="",t.beginTime="",t.endTime="",t.conf.currentPage=1,t.bigTab=[{tab:!1},{tab:!0},{tab:!1},{tab:!1}],d(t.param),s(2)},t.waterApprovalthree=function(){t.selectAll=!0,t.selected=[],t.mode=3,t.dayCount="",t.beginTime="",t.endTime="",t.conf.currentPage=1,t.bigTab=[{tab:!1},{tab:!1},{tab:!0},{tab:!1}],p(t.param),s(3)},t.waterApprovalfour=function(){t.selectAll=!0,t.selected=[],t.mode=3,t.dayCount="",t.beginTime="",t.endTime="",t.conf.currentPage=1,t.bigTab=[{tab:!1},{tab:!1},{tab:!1},{tab:!0}],u(t.param),s(4)},t.typeLocation=function(e,a){if(i.paramsVal1=t.param,i.paramstype=a,"2"==a){var o=t.waterRows[e].id,s=t.waterRows[e].type,r=t.waterRows[e].is_done,l=t.waterRows[e].statusValue,c=t.waterRows[e].pactId,d=t.waterRows[e].updateStatus;n.go("commissionPayment",{projectid:t.projectId,roomId:"",approveId:o,number:s,flag:r,updateStatus:d})}else{if("3"==a)var p=t.threeList[e].id,u=t.threeList[e].subjectId,m=t.threeList[e].type,f=t.threeList[e].is_done,l=t.threeList[e].statusValue,c=t.threeList[e].pactId,d=t.threeList[e].updateStatus;else if("4"==a)var p=t.fourList[e].id,u=t.fourList[e].propertyId,m=t.fourList[e].type,f=t.fourList[e].is_done,l=t.fourList[e].statusValue,c=t.fourList[e].pactId,d=t.fourList[e].updateStatus;else var p=t.propertys[e].id,u=t.propertys[e].propertyId,m=t.propertys[e].type,f=t.propertys[e].is_done,l=t.propertys[e].statusValue,c=t.propertys[e].pactId,d=t.propertys[e].updateStatus;switch(m){case 100:case 200:case 300:case 400:case 500:case 600:case 700:case 800:case 900:case 1e3:case 1100:case 1200:case 1400:case 1600:case 1700:n.go("surveyingMapping",{projectid:t.projectId,roomId:u,approveId:p,number:m,flag:f,status:l,pactId:c,updateStatus:d});break;default:n.go("surveyingMapping",{projectid:t.projectId,roomId:u,approveId:p,number:m,flag:f,status:l,pactId:c,updateStatus:d})}}}}]).controller("examineExaminationCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){t.projectId=n.params.projectid,t.approvalId=n.params.approvalId,t.param={approvalId:t.approvalId,projectId:t.projectId},a.server().approvalformDetail(t.param,function(e){!0===e.result?(t.approval=e.data,console.log(t.approval.roomMsg.address),t.$apply()):alert(e.message)})}]).controller("financeCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e,n,o,i,s,r){a.server().criterialist({projectId:t.projectId,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,searchKeys:t.ppnameinput?t.ppnameinput:"",financeId:e||"",paymentStatus:n||"",beginTime:o||"",endTime:i||"",type:s||"",exportType:r,paymentType:1},function(e){if(!0===e.result){t.list=e.data.rows;for(var a=0;a<t.list.length;a++)0==t.list[a].paymentStatus?t.list[a].payment="未支付":1==t.list[a].paymentStatus?t.list[a].payment="已支付":2==t.list[a].paymentStatus?t.list[a].payment="截留":3==t.list[a].paymentStatus?t.list[a].payment="未收款":3==t.list[a].paymentStatus&&(t.list[a].payment="已收款");t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)})}var r=setInterval(function(){$(".l-nav>li").length>0&&($(".l-nav>li").eq(7).addClass("cur"),clearInterval(r))},10),l=a.server().userId;t.projectId=n.params.projectid,t.hostName=a.server().imgHost,t.myscrol=!0,t.scrolldiv=function(){t.myscrol=!t.myscrol},a.server().searchCriterialist({projectId:t.projectId},function(e){if(!0===e.result){t.criterialist=e.data;for(var a=0;a<t.criterialist.length;a++)t.criterialist[a].state=!1;t.$apply()}else alert(e.message)}),t.paylist=[{id:"0",name:"未支付",state:!1},{id:"1",name:"已支付",state:!1}],t.selectall=!0,t.payselectall=!0,t.selected=[],t.payselected=[],t.updateSelection=function(e,a,n,o){if(1==n?(t.selected=[],t.selectall=!1):(t.payselected=[],t.payselectall=!1),a){var i=0;o.forEach(function(e,t){o[t].state&&i++}),i==o.length&&(1==n?t.selectall=!0:t.payselected=!0)}else{var r=0;o.forEach(function(e,t){o[t].state||r++}),r==o.length&&(o[e].state=!0)}1!=n||t.selectall||o.forEach(function(e,a){o[a].state&&t.selected.push(o[a].id)}),2==n&&t.payselected&&o.forEach(function(e,a){o[a].state&&t.payselected.push(o[a].id)}),t.selected=t.selected.toString(),t.payselected=t.payselected.toString(),console.log(t.paylist),s(t.selected,t.payselected,t.starttime,t.endtime,t.type,t.exporttype)},t.checktall=function(e,a,n){t.selected="",e?n.forEach(function(e,t){e.state=!1}):1==a?t.selectall=!0:t.payselected=!0,1==a?t.selected="":t.payselected="",s(t.selected,t.payselected,t.starttime,t.endtime,t.type,t.exporttype)},t.mychange=function(e,a,n,o,i){laydate.render({elem:".test1",format:"yyyy-MM-dd",show:!0,closeStop:".test2",done:function(e){t.starttime=e,s(a,n,t.starttime,o,t.type,i)}})},t.mychange2=function(e,a,n,o,i){laydate.render({elem:".test3",format:"yyyy-MM-dd",show:!0,closeStop:".test4",done:function(e){t.endtime=e,s(a,n,o,t.endtime,t.type,i)}})},t.flag=!1,t.flag2=!1,t.type="",t.seven=function(e,a,n,o,i,r){1==t.type?t.type="":t.type=1,t.flag=!t.flag,t.flag2=!1,s(a,n,o,i,t.type,r)},t.month=function(e,a,n,o,i,r){2==t.type?t.type="":t.type=2,t.flag=!1,t.flag2=!t.flag2,s(a,n,o,i,t.type,r)},t.no="暂无数据",t.conf={total:10,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+ppnameinput",function(e){s(t.selected,t.payselected,t.starttime,t.endtime,t.type,t.exporttype)});var c=[];t.batchselect=function(e,a){t.batchChecked=!1},t.batchAll=function(e){if(e.target.checked)for(var a=0;a<t.list.length;a++)t.list[a].checked=!0;else for(var a=0;a<t.list.length;a++)t.list[a].checked=!1},t.payapply=function(){$(".saveDisabled").attr("disabled","disabled");for(var e=0;e<t.list.length;e++)(1==t.list[e].checked&&0==t.list[e].examineStatus||2==t.list[e].examineStatus)&&c.push(t.list[e].id);a.server().payapplylist({paymentId:c.toString(),userId:l},function(e){!0===e.result?(alert(e.message,function(){s(),t.batchChecked=!1,c=[],$(".saveDisabled").removeAttr("disabled")}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){alert(data.message,function(){$(".saveDisabled").removeAttr("disabled")})})},t.exporttype="",t.export=function(e,a,n,o,i){t.exporttype="1",t.exporttypeUrl=t.hostName+"payment/queryFinanceList.do?projectId="+t.projectId+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit+"&searchKeys="+(t.ppnameinput?t.ppnameinput:"")+"&financeId="+(e||"")+"&paymentStatus="+(a||"")+"&beginTime="+(n||"")+"&endTime="+(o||"")+"&type="+(i||"")+"&exportType="+t.exporttype+"&paymentType=1",t.exporttype=""},t.paySingle=function(e){a.server().payapplylist({paymentId:e,userId:l},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})}}]).controller("delayfinanceCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e,n,o,i,s,r){a.server().criterialist({projectId:t.projectId,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,searchKeys:t.ppnameinput?t.ppnameinput:"",financeId:e||"",paymentStatus:n||"",beginTime:o||"",endTime:i||"",type:s||"",exportType:r,paymentType:2},function(e){if(!0===e.result){t.list=e.data.rows;for(var a=0;a<t.list.length;a++)0==t.list[a].paymentStatus?t.list[a].payment="未支付":1==t.list[a].paymentStatus?t.list[a].payment="已支付":2==t.list[a].paymentStatus?t.list[a].payment="截留":3==t.list[a].paymentStatus?t.list[a].payment="未收款":3==t.list[a].paymentStatus&&(t.list[a].payment="已收款");t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)})}var r=setInterval(function(){$(".l-nav>li").length>0&&($(".l-nav>li").eq(7).addClass("cur"),clearInterval(r))},10),l=a.server().userId;t.projectId=n.params.projectid,t.hostName=a.server().imgHost,t.myscrol=!0,t.scrolldiv=function(){t.myscrol=!t.myscrol},a.server().searchCriterialist({projectId:t.projectId},function(e){if(!0===e.result){t.criterialist=e.data;for(var a=0;a<t.criterialist.length;a++)t.criterialist[a].state=!1;t.$apply()}else alert(e.message)}),t.paylist=[{id:0,name:"未支付",state:!1},{id:1,name:"已支付",state:!1}];var c=[],d=[],p=/^[0-9]*$/;t.selected="",t.payselected="",t.updateSelection=function(e,a,n,o,i,r){if(e.target.checked)p.test(a)?(d.push(a),t.payselected=d.toString()):(c.push(a),t.selected=c.toString());else if(p.test(a)){var l=d.indexOf(a);d.splice(l,1),t.payselected=d.toString()}else{var u=c.indexOf(a);c.splice(u,1),t.selected=c.toString()}0===t.selected.length?t.selectall=!0:t.selectall=!1,0===t.payselected.length?t.payselectall=!0:t.payselectall=!1,s(t.selected,t.payselected,n,o,i,r)},t.selectall=!0,t.payselectall=!0,t.checktall=function(e,a,n,o,i,r,l){if(console.log(n),!1===e&&(0===t.selected.length&&(t.selectall=!0),0===t.payselected.length&&(t.payselectall=!0)),!0===e){if("selectall"==a){c.length=0,t.selected="";for(var p=0;p<t.criterialist.length;p++)t.criterialist[p].state=!1;s(c,n,o,i,r,l)}if("payselectall"==a){d.length=0,t.payselected="";for(var p=0;p<t.paylist.length;p++)t.paylist[p].state=!1;s(n,d,o,i,r,l)}}},t.mychange=function(e,a,n,o,i){laydate.render({elem:".test1",format:"yyyy-MM-dd",show:!0,closeStop:".test2",done:function(e){t.starttime=e,s(a,n,t.starttime,o,t.type,i)}})},t.mychange2=function(e,a,n,o,i){laydate.render({elem:".test3",format:"yyyy-MM-dd",show:!0,closeStop:".test4",done:function(e){t.endtime=e,s(a,n,o,t.endtime,t.type,i)}})},t.flag=!1,t.flag2=!1,t.type="",t.seven=function(e,a,n,o,i,r){1==t.type?t.type="":t.type=1,t.flag=!t.flag,t.flag2=!1,s(a,n,o,i,t.type,r)},t.month=function(e,a,n,o,i,r){2==t.type?t.type="":t.type=2,t.flag=!1,t.flag2=!t.flag2,s(a,n,o,i,t.type,r)},t.no="暂无数据",t.conf={total:10,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+ppnameinput",function(e){s(t.selected,t.payselected,t.starttime,t.endtime,t.type,t.exporttype)});var u=[];t.batchselect=function(e,a){t.batchChecked=!1},t.batchAll=function(e){if(e.target.checked)for(var a=0;a<t.list.length;a++)t.list[a].checked=!0;else for(var a=0;a<t.list.length;a++)t.list[a].checked=!1},t.payapply=function(){$(".saveDisabled").removeAttr("disabled");for(var e=0;e<t.list.length;e++)(1==t.list[e].checked&&0==t.list[e].examineStatus||2==t.list[e].examineStatus)&&u.push(t.list[e].id);a.server().payapplylist({paymentId:u.toString(),userId:l},function(e){!0===e.result?(alert(e.message,function(){s(),t.batchChecked=!1,u=[],$(".saveDisabled").removeAttr("disabled")}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){alert(data.message,function(){$(".saveDisabled").removeAttr("disabled")})})},t.exporttype="",t.export=function(e,a,n,o,i){t.exporttype="1",t.exporttypeUrl=t.hostName+"payment/queryFinanceList.do?projectId="+t.projectId+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit+"&searchKeys="+(t.ppnameinput?t.ppnameinput:"")+"&financeId="+(e||"")+"&paymentStatus="+(a||"")+"&beginTime="+(n||"")+"&endTime="+(o||"")+"&type="+(i||"")+"&exportType="+t.exporttype+"&paymentType=2",t.exporttype=""},t.paySingle=function(e){a.server().payapplylist({paymentId:e,userId:l},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)})}}]).controller("commissionfinanceCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e,n,o,i,s,r){a.server().commissionlist({projectId:t.projectId,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,searchKeys:t.ppnameinput?t.ppnameinput:"",status:e||"",paymentStatus:n||"",type:s||"",beginTime:o||"",endTime:i||"",exportType:r},function(e){if(!0===e.result){t.list=e.data.rows;for(var a=0;a<t.list.length;a++)0==t.list[a].paymentStatus?t.list[a].payment="未支付":1==t.list[a].paymentStatus?t.list[a].payment="已支付":2==t.list[a].paymentStatus?t.list[a].payment="截留":3==t.list[a].paymentStatus?t.list[a].payment="未收款":3==t.list[a].paymentStatus&&(t.list[a].payment="已收款");for(var a=0;a<t.list.length;a++)1==t.list[a].type?t.list[a].comtype="签约佣金":2==t.list[a].type?t.list[a].comtype="违建佣金":3==t.list[a].type&&(t.list[a].comtype="综合业务佣金");t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)})}var r=a.server().userId;t.hostName=a.server().imgHost,t.projectId=n.params.projectid,t.myscrol=!0,t.scrolldiv=function(){t.myscrol=!t.myscrol},t.paylist=[{id:0,name:"未支付",state:!1},{id:1,name:"已支付",state:!1}],t.commissiontype=[{id:1,name:"签约佣金",state:!1},{id:2,name:"违建佣金",state:!1},{id:3,name:"综合业务佣金",state:!1}];var l=[],c=[];t.selected="",t.payselected="",t.updateSelection=function(e,a,n,o,i,r){var d=e.target;console.log(d);var p=d.name;if(console.log(p),d.checked)"pay"==p?(c.push(a),t.payselected=c.toString()):"commission"==p&&(l.push(a),t.selected=l.toString());else if("pay"==p){var u=c.indexOf(a);c.splice(u,1),t.payselected=c.toString()}else if("commission"==p){var m=l.indexOf(a);l.splice(m,1),t.selected=l.toString()}0===t.selected.length?t.selectall=!0:t.selectall=!1,0===t.payselected.length?t.payselectall=!0:t.payselectall=!1,s(t.selected,t.payselected,n,o,i,r)},t.selectall=!0,t.payselectall=!0,t.checktall=function(e,a,n,o,i,r,d){if(console.log(n),!1===e&&(0===t.selected.length&&(t.selectall=!0),0===t.payselected.length&&(t.payselectall=!0)),!0===e){if("selectall"==a){l.length=0,t.selected="";for(var p=0;p<t.commissiontype.length;p++)t.commissiontype[p].state=!1;s(l,n,o,i,r,d)}if("payselectall"==a){c.length=0,t.payselected="";for(var p=0;p<t.paylist.length;p++)t.paylist[p].state=!1;s(n,c,o,i,r,d)}}},t.mychange=function(e,a,n,o,i){laydate.render({elem:".test1",format:"yyyy-MM-dd",show:!0,closeStop:".test2",done:function(e){t.starttime=e,s(a,n,t.starttime,o,t.type,i)}})},t.mychange2=function(e,a,n,o,i){laydate.render({elem:".test3",format:"yyyy-MM-dd",show:!0,closeStop:".test4",done:function(e){t.endtime=e,s(a,n,o,t.endtime,t.type,i)}})};var d=[];t.batchselect=function(e,a){t.batchChecked=!1},t.batchAll=function(e){if(e.target.checked)for(var a=0;a<t.list.length;a++)t.list[a].checked=!0;else for(var a=0;a<t.list.length;a++)t.list[a].checked=!1},t.commissionapply=function(){$(".saveDisabled").attr("disabled","disabled");for(var e=0;e<t.list.length;e++)(1==t.list[e].checked&&0==t.list[e].examineStatus||2==t.list[e].examineStatus)&&d.push(t.list[e].id);a.server().commissionapplylist({commisionId:d.toString(),userId:r},function(e){!0===e.result?(alert(e.message,function(){t.batchChecked=!1,s(),d=[],$(".saveDisabled").removeAttr("disabled")}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){alert(data.message,function(){$(".saveDisabled").removeAttr("disabled")})})},t.flag=!1,t.flag2=!1,t.type="",t.seven=function(e,a,n,o,i,r){t.flag=!t.flag,1==t.flag?t.type=1:t.type="",t.flag2=!1,s(a,n,o,i,t.type,r)},t.month=function(e,a,n,o,i,r){t.flag=!1,t.flag2=!t.flag2,1==t.flag2?t.type=2:t.type="",s(a,n,o,i,t.type,r)},t.no="暂无数据",t.conf={total:10,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+ppnameinput",function(){s(t.selected,t.payselected,t.starttime,t.endtime,t.type,t.exporttype)}),t.exporttype="",t.export=function(e,a,n,o,i){t.exporttype="1",t.exporttypeUrl=t.hostName+"signedcommission/financeCommision.do?projectId="+t.projectId+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit+"&searchKeys="+(t.ppnameinput?t.ppnameinput:"")+"&status="+(e||"")+"&paymentStatus="+(a||"")+"&beginTime="+(n||"")+"&endTime="+(o||"")+"&type="+(i||"")+"&exportType="+t.exporttype,t.exporttype=""}}]).controller("payfinanceCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){a.server().userId;t.projectId=n.params.projectid,t.myscrol=!0,t.scrolldiv=function(){t.myscrol=!t.myscrol},t.no="暂无数据",function(){a.server().payfinancelist({projectId:t.projectId},function(e){if(!0===e.result){t.statisticslist=e.data;for(var a=0;a<t.statisticslist.length;a++)1==t.statisticslist[a].type?t.statisticslist[a].payfinancetype="物业补偿":2==t.statisticslist[a].type?t.statisticslist[a].payfinancetype="安置补助补偿":3==t.statisticslist[a].type?t.statisticslist[a].payfinancetype="延期支付补偿":4==t.statisticslist[a].type&&(t.statisticslist[a].payfinancetype="佣金");for(var a=0;a<t.statisticslist.length;a++)0==t.statisticslist[a].paymentStatus?t.statisticslist[a].payment="未支付":1==t.statisticslist[a].paymentStatus?t.statisticslist[a].payment="已支付":2==t.statisticslist[a].paymentStatus?t.statisticslist[a].payment="截留":3==t.statisticslist[a].paymentStatus?t.statisticslist[a].payment="未收款":3==t.statisticslist[a].paymentStatus&&(t.statisticslist[a].payment="已收款");t.$apply()}else alert(e.message)},function(e){})}(),t.showPayList=function(){t.payListFlag=!0}}]).controller("paylistCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e,n){a.server().paydatalist({projectId:t.projectId,type:t.type,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,status:e,exportType:n},function(e){if(!0===e.result){t.list=e.data.rows;for(var a=0;a<t.list.length;a++)t.list[a].paySatus=!1,0==t.list[a].paymentStatus?t.list[a].payment="未支付":1==t.list[a].paymentStatus&&(t.list[a].payment="已支付");t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)},function(e){})}function r(e,n){a.server().paycommissiondatalist({projectId:t.projectId,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,status:e,exportType:n},function(e){if(!0===e.result){t.commissionlist=e.data.rows;for(var a=0;a<t.commissionlist.length;a++)t.commissionlist[a].paySatus=!1,0==t.commissionlist[a].paymentStatus?t.commissionlist[a].payment="未支付":1==t.commissionlist[a].paymentStatus&&(t.commissionlist[a].payment="已支付");for(var a=0;a<t.commissionlist.length;a++)1==t.commissionlist[a].type?t.commissionlist[a].comtype="签约佣金":2==t.commissionlist[a].type?t.commissionlist[a].comtype="违建佣金":3==t.commissionlist[a].type&&(t.commissionlist[a].comtype="综合业务佣金");t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)},function(e){})}function l(e){a.server().paymoneynow({id:e},function(e){!0===e.result?(alert(e.message,function(){r(),t.batchChecked=!1,$(".saveDisabled").removeAttr("disabled")}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){alert(data.message,function(){$(".saveDisabled").removeAttr("disabled")})})}function c(e){a.server().paynow({id:e},function(e){!0===e.result?(alert(e.message,function(){s(),t.batchChecked=!1,$(".saveDisabled").removeAttr("disabled")}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){alert(data.message,function(){$(".saveDisabled").removeAttr("disabled")})})}t.projectId=n.params.projectid,t.downloadUrl=a.server().imgHost;a.server().userId;t.type=n.params.type,t.no="暂无数据",t.myscrol=!0,t.batchChecked=!1,t.scrolldiv=function(){t.myscrol=!t.myscrol},t.paylist=[{id:0,name:"未支付",state:!1},{id:1,name:"已支付",state:!1}];var d=[];t.payselected="",t.updateSelection=function(e,a,n){if(e.target.checked)d.push(a),t.payselected=d.toString();else{var o=d.indexOf(a);d.splice(o,1),t.payselected=d.toString()}0===t.payselected.length?t.payselectall=!0:t.payselectall=!1,4==t.type?r(t.payselected,n):s(t.payselected,n)},t.exportType=0,t.export=function(e){t.exporttype=1,4==t.type?t.exporttypeUrl=t.downloadUrl+"payment/commisionPaymentList.do?projectId="+t.projectId+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit+"&status="+(e||"")+"&type="+(t.type?t.type:"")+"&exportType="+t.exporttype:t.exporttypeUrl=t.downloadUrl+"payment/paymentList.do?projectId="+t.projectId+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit+"&status="+(e||"")+"&type="+(t.type?t.type:"")+"&exportType="+t.exporttype,t.exporttype=0},t.payselectall=!0,t.checktall=function(e,a,n){if(!1===e&&0===t.payselected.length&&(t.payselectall=!0),!0===e&&"payselectall"==a){d.length=0,t.payselected="";for(var o=0;o<t.paylist.length;o++)t.paylist[o].state=!1;4==t.type?r(t.payselected,n):s(t.payselected,n)}},4!=t.type?a.server().payheadlist({projectId:t.projectId,type:t.type},function(e){if(!0===e.result){if(t.headlist=e.data,null!=t.headlist){for(var a=0;a<t.headlist.length;a++)1==t.headlist[a].type?t.headlist[a].payfinancetype="物业补偿":2==t.headlist[a].type?t.headlist[a].payfinancetype="安置补助补偿":3==t.headlist[a].type?t.headlist[a].payfinancetype="延期支付补偿":4==t.headlist[a].type&&(t.headlist[a].payfinancetype="佣金");for(var a=0;a<t.headlist.length;a++)0==t.headlist[a].paymentStatus?t.headlist[a].payment="未支付":1==t.headlist[a].paymentStatus?t.headlist[a].payment="已支付":2==t.headlist[a].paymentStatus?t.headlist[a].payment="截留":3==t.headlist[a].paymentStatus?t.headlist[a].payment="未收款":3==t.headlist[a].paymentStatus&&(t.headlist[a].payment="已收款")}t.$apply()}else alert(e.message)},function(e){}):a.server().paycommissionheadlist({projectId:t.projectId},function(e){if(!0===e.result){if(t.headcommissionlist=e.data,null!=t.headcommissionlist){for(var a=0;a<t.headcommissionlist.length;a++)1==t.headcommissionlist[a].type?t.headcommissionlist[a].payfinancetype="物业补偿":2==t.headcommissionlist[a].type?t.headcommissionlist[a].payfinancetype="安置补助补偿":3==t.headcommissionlist[a].type?t.headcommissionlist[a].payfinancetype="延期支付补偿":4==t.headcommissionlist[a].type&&(t.headcommissionlist[a].payfinancetype="佣金");for(var a=0;a<t.headcommissionlist.length;a++)0==t.headcommissionlist[a].paymentStatus?t.headcommissionlist[a].payment="未支付":1==t.headcommissionlist[a].paymentStatus?t.headcommissionlist[a].payment="已支付":2==t.headcommissionlist[a].paymentStatus?t.headcommissionlist[a].payment="截留":3==t.headcommissionlist[a].paymentStatus?t.headcommissionlist[a].payment="未收款":3==t.headcommissionlist[a].paymentStatus&&(t.headcommissionlist[a].payment="已收款")}t.$apply()}else alert(e.message)},function(e){}),t.no="暂无数据",t.conf={total:10,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit",function(){4==t.type?r(t.payselected,t.exportType):s(t.payselected,t.exportType)}),t.paymoney=function(e){l(e)},t.pay=function(e){c(e)},t.batchselect=function(){t.batchChecked=!1},t.batchAll=function(e,a){var n=e.target,o=n.checked;if(4!=a)if(o)for(var i=0;i<t.list.length;i++)t.list[i].paySatus=!0;else for(var i=0;i<t.list.length;i++)t.list[i].paySatus=!1;else if(o)for(var i=0;i<t.commissionlist.length;i++)t.commissionlist[i].paySatus=!0;else for(var i=0;i<t.commissionlist.length;i++)t.commissionlist[i].paySatus=!1},t.payAll=function(e,a){if($(".saveDisabled").attr("disabled","disabled"),4==t.type){var n=[];e.forEach(function(e,t){1==e.paySatus&&0==e.paymentStatus&&n.push(e.id)}),l(n.toString())}else{var n=[];a.forEach(function(e,t){1==e.paySatus&&0==e.paymentStatus&&n.push(e.id)}),c(n.toString())}}}]).controller("financialsettlementCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().settlementlist({projectId:t.projectId},function(e){if(!0===e.result){t.settlementlist=e.data;for(var a=0;a<t.settlementlist.length;a++){1==t.settlementlist[a].type?t.settlementlist[a].typement="物业补偿类":2==t.settlementlist[a].type?t.settlementlist[a].typement="安置补助类":3==t.settlementlist[a].type&&(t.settlementlist[a].typement="延期支付类");for(var n=0;n<t.settlementlist[a].detailList.length;n++)t.settlementlist[a].detailList[n].type=t.settlementlist[a].type}t.$apply()}else alert(e.message)},function(e){})}function r(e,n,o,i){a.server().contactcommission({projectId:t.projectId,type:e,status:n},function(e){!0===e.result?(console.log(e.data),t.newcontactlist=e.data,t.contactlist=e.data,t.newcontactlist.forEach(function(e,a){t.newcontactlist[a].state=!1}),t.contactlist.forEach(function(e,a){
t.contactlist[a].state=!1}),o&&i(t.contactlist),t.$apply()):alert(e.message)},function(e){})}function l(){t.contactJson.length=0,t.newdetailJson=[{isProtocol:1,ruleIdOne:"",ruleIdTwo:"",scale:"",paymentBasis:"",ruleTwoData:"",paymentMode:1,childType:1,nodeOneId:"",nodeTwoId:"",stagelist:"",stagelist2:""}],t.newcontactlist.forEach(function(e,a){t.newcontactlist[a].state=!1}),t.newprojectname="",t.detailJson=[],t.newcontactlist.forEach(function(e,a){t.newcontactlist[a].state=!1}),t.flag=!1,$(".saveDisabled").removeAttr("disabled")}function c(e,n,o){a.server().paynodeson({parentId:e},function(e){!0===e.result?(1==o?t.detailJson[n].stagelist=e.data:t.detailJson[n].stagelist2=e.data,t.$apply()):alert(e.message)},function(e){})}t.projectId=n.params.projectid;var d=a.server().userId;t.list={projectId:n.params.projectid,createUser:a.server().userId,toUserId:a.server().userId,type:3,status:1},t.listtop={roomId:n.params.projectid,projectId:n.params.projectid,paciId:t.pactId,createUser:a.server().userId,imgHost:a.server().imgHost,questiontype:4,projectflag:1,reloadajax:1,locationflag:1},s(),t.addnewproject=function(e){$("."+e).dialog()},t.compensationDialog=function(e){$("."+e).dialog(),r(1,1)},t.delayDialog=function(e){$("."+e).dialog(),r(3,1)},t.helpDialog=function(e){$("."+e).dialog(),r(2,1)},a.server().paynodeparent({},function(e){!0===e.result?(t.nodelist=e.data,t.$apply()):alert(e.message)},function(e){}),t.getid=function(e,n,o,i){a.server().paynodeson({parentId:e},function(e){!0===e.result?("new"==o&&1==i?t.newdetailJson[n].stagelist2=e.data:"new"==o&&(t.newdetailJson[n].stagelist=e.data),"update"==o&&2==i?t.detailJson[n].stagelist2=e.data:"update"==o&&(t.detailJson[n].stagelist=e.data),t.$apply()):alert(e.message)},function(e){})},t.flag=!1,t.show=function(e){1==e?(t.newdetailJson.push({isProtocol:1,ruleIdOne:"",ruleIdTwo:"",scale:"",paymentBasis:"",ruleTwoData:"",paymentMode:1,childType:1,nodeOneId:"",nodeTwoId:"",stagelist:"",stagelist2:"",amount:""}),t.newdetailJson.length>=3?t.flag=!0:t.flag=!1):(t.detailJson.push({isProtocol:1,ruleIdOne:"",ruleIdTwo:"",scale:"",paymentBasis:"",ruleTwoData:"",paymentMode:1,childType:1,nodeOneId:"",nodeTwoId:"",stagelist:"",stagelist2:"",amount:""}),t.detailJson.length>=3?t.flag=!0:t.flag=!1)},t.contactJson=[],t.newdetailJson=[{isProtocol:1,ruleIdOne:"",ruleIdTwo:"",scale:"",paymentBasis:"",ruleTwoData:"",paymentMode:1,childType:1,nodeOneId:"",nodeTwoId:"",stagelist:"",stagelist2:"",amount:""}],t.detailJson=[];t.contactJson=[],t.isMonth=!0,t.isHelp=!0,t.addcommission=function(e){$(".saveDisabled").attr("disabled","disabled");for(var n=[],o=0;o<t.contactlist.length;o++)1==t.contactlist[o].state&&n.push({compensateProjectId:t.contactlist[o].compensateProjectId,typeId:t.contactlist[o].compensationId});for(var i=[],r=0;r<t.newdetailJson.length;r++)i.push({isProtocol:t.newdetailJson[r].isProtocol,ruleIdOne:t.newdetailJson[r].ruleIdOne,ruleIdTwo:t.newdetailJson[r].ruleIdTwo?t.newdetailJson[r].ruleIdTwo:"",scale:t.newdetailJson[r].scale,paymentBasis:t.newdetailJson[r].paymentBasis,ruleTwoData:t.newdetailJson[r].ruleTwoData,paymentMode:t.newdetailJson[r].paymentMode,childType:t.newdetailJson[r].childType,nodeOneId:t.newdetailJson[r].nodeOneId,nodeTwoId:t.newdetailJson[r].nodeTwoId?t.newdetailJson[r].nodeTwoId:"",amount:t.newdetailJson[r].amount});1==e?a.server().addnewcommission({projectId:t.projectId,type:e,name:t.newprojectname,userId:d,contactJson:JSON.stringify(n),detailJson:JSON.stringify(i)},function(e){!0===e.result?(alert(e.message,function(){$(".addnew").hide(),$(".addcompensation").hide(),$(".saveDisabled").removeAttr("disabled"),l(),s(),t.$apply()}),t.$apply()):alert(e.message,function(){l(),s(),$(".saveDisabled").removeAttr("disabled"),t.$apply()})},function(e){alert(data.message,function(){l(),s(),$(".saveDisabled").removeAttr("disabled"),t.$apply()})}):2==e?(t.newdetailJson[0].isProtocol="",a.server().addnewcommission({projectId:t.projectId,type:e,name:t.newprojectname,userId:d,contactJson:JSON.stringify(n),detailJson:JSON.stringify(i)},function(e){!0===e.result?(alert(e.message,function(){s(),$(".addnew").hide(),$(".addhelp").hide(),$(".saveDisabled").removeAttr("disabled"),l(),t.$apply()}),t.$apply()):alert(e.message,function(){l(),s(),$(".saveDisabled").removeAttr("disabled"),t.$apply()})},function(e){alert(data.message,function(){l(),s(),$(".saveDisabled").removeAttr("disabled"),t.$apply()})})):3==e&&a.server().addnewcommission({projectId:t.projectId,type:e,name:t.newprojectname,userId:d,contactJson:JSON.stringify(n),detailJson:JSON.stringify(i)},function(e){!0===e.result?(alert(e.message,function(){s(),$(".addnew").hide(),$(".adddelay").hide(),$(".saveDisabled").removeAttr("disabled"),l(),t.$apply()}),t.$apply()):alert(e.message,function(){l(),s(),$(".saveDisabled").removeAttr("disabled"),t.$apply()})},function(e){alert(data.message,function(){l(),s(),$(".saveDisabled").removeAttr("disabled"),t.$apply()})})},t.cancel=function(){l()},t.opendilog=function(e,n){console.log(n),1==e?setTimeout(function(){$(".updatecompensation").dialog()},300):2==e?setTimeout(function(){$(".updatehelp").dialog()},300):3==e&&setTimeout(function(){$(".updatedelay").dialog()},300),r(e,2,!0,function(o){a.server().updatenewcommission({id:n},function(a){if(1==a.result){t.content=a.data.content,t.detail=a.data.detail,t.settlement=a.data.settlement,t.projectname=t.settlement.name,console.log(o),console.log(t.content);for(var n=0;n<o.length;n++)for(var i=0;i<t.content.length;i++)o[n].compensateProjectId==t.content[i].compensateProjectId&&o[n].compensationId==t.content[i].typeId&&(o[n].state=!0);for(var n=0;n<t.detail.length;n++)t.detailJson.push({isProtocol:"",ruleIdOne:"",ruleIdTwo:"",scale:"",paymentBasis:"",ruleTwoData:"",paymentMode:"",childType:"",nodeOneId:"",stagelist:"",stagelist2:"",nodeTwoId:"",amount:""}),t.detailJson[n]={isProtocol:t.detail[n].isProtocol,ruleIdOne:t.detail[n].ruleIdOne,ruleIdTwo:t.detail[n].ruleIdTwo,scale:t.detail[n].scale,paymentBasis:t.detail[n].paymentBasis,ruleTwoData:t.detail[n].ruleTwoData,paymentMode:t.detail[n].paymentMode,childType:t.detail[n].childType,nodeOneId:t.detail[n].nodeOneId,amount:t.detail[n].amount,stagelist:"",stagelist2:"",nodeTwoId:t.detail[n].nodeTwoId},""!=t.detail[n].ruleIdTwo&&c(t.detailJson[n].ruleIdOne,n,1),""!=t.detail[n].nodeTwoId&&c(t.detailJson[n].nodeOneId,n,2);3==t.detail.length&&(t.flag=!0),console.log(t.detailJson),t.$apply()}else alert(a.message,function(){1==e?$(".updatecompensation").hide():2==e?$(".updatehelp").hide():3==e&&$(".updatedelay").hide()})},function(e){})})},t.updatesavecommission=function(e){$(".saveDisabled").attr("disabled","disabled");for(var n=[],o=0;o<t.contactlist.length;o++)1==t.contactlist[o].state&&n.push({compensateProjectId:t.contactlist[o].compensateProjectId,typeId:t.contactlist[o].compensationId});for(var i=[],r=0;r<t.detailJson.length;r++)i.push({isProtocol:t.detailJson[r].isProtocol,ruleIdOne:t.detailJson[r].ruleIdOne,ruleIdTwo:t.detailJson[r].ruleIdTwo?t.detailJson[r].ruleIdTwo:"",scale:t.detailJson[r].scale,paymentBasis:t.detailJson[r].paymentBasis,ruleTwoData:t.detailJson[r].ruleTwoData,paymentMode:t.detailJson[r].paymentMode,childType:t.detailJson[r].childType,nodeOneId:t.detailJson[r].nodeOneId,nodeTwoId:t.detailJson[r].nodeTwoId?t.detailJson[r].nodeTwoId:"",amount:t.detailJson[r].amount});1==e?a.server().updatesavenewcommission({id:t.settlement.id,projectId:t.projectId,type:e,name:t.projectname,userId:d,contactJson:JSON.stringify(n),detailJson:JSON.stringify(i)},function(e){!0===e.result?(alert(e.message,function(){$(".updatecompensation").hide(),$(".saveDisabled").removeAttr("disabled"),l(),s()}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){alert(data.message,function(){$(".saveDisabled").removeAttr("disabled")})}):2==e?a.server().updatesavenewcommission({id:t.settlement.id,projectId:t.projectId,type:e,name:t.projectname,userId:d,contactJson:JSON.stringify(n),detailJson:JSON.stringify(i)},function(e){!0===e.result?(alert(e.message,function(){$(".updatehelp").hide(),$(".saveDisabled").removeAttr("disabled"),l(),s()}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){}):3==e&&a.server().updatesavenewcommission({id:t.settlement.id,projectId:t.projectId,type:e,name:t.projectname,userId:d,contactJson:JSON.stringify(n),detailJson:JSON.stringify(i)},function(e){!0===e.result?(alert(e.message,function(){$(".updatedelay").hide(),$(".saveDisabled").removeAttr("disabled"),l(),s()}),t.$apply()):alert(e.message,function(){$(".saveDisabled").removeAttr("disabled")})},function(e){alert(data.message,function(){$(".saveDisabled").removeAttr("disabled")})})},t.deleteFinance=function(e,n){confirm("确认删除"+e+"?",function(){a.server().deleteFinanceSet({id:n,userId:d},function(e){!0===e.result?(alert(e.message,function(){window.locaion.reload()}),t.$apply()):alert(e.message)},function(e){})})},t.deleteProcess=function(e,a){0==e?(t.newdetailJson.splice(a,1),console.log(t.newdetailJson),t.newdetailJson.length<3&&(t.flag=!1)):(t.detailJson.splice(a,1),console.log(t.detailJson),t.detailJson.length<3&&(t.flag=!1))}}]).controller("databasicSignCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().datasignList({},function(e){!0===e.result?(t.datalist=e.data,t.$apply()):alert(e.message)},function(e){})}function r(e){a.server().signeditinit({id:e},function(e){!0===e.result?(t.parenteditsignname=e.data.name,t.isFinishedTime=1==e.data.isFinishedTime,t.isReleaseTask=1==e.data.isReleaseTask,t.$apply()):alert(e.message)},function(e){})}function l(e,n,o,i,r){a.server().signEditParentSave({id:e,name:n,updateUser:o,isFinishedTime:i,isReleaseTask:r},function(e){!0===e.result?(alert(e.message),t.isFinishedTime=!1,t.isReleaseTask=!1,s(),t.$apply()):alert(e.message)},function(e){})}function c(e,n,o,i,r,l){a.server().signeditsave({id:e,name:n,parentId:o,updateUser:i,isFinishedTime:r,isReleaseTask:l},function(e){!0===e.result?(alert(e.message),t.isFinishedTime=!1,t.isReleaseTask=!1,s(),t.$apply()):alert(e.message)},function(e){})}function d(e){a.server().signdelete({id:e},function(e){!0===e.result?(alert(e.message),s(),t.$apply()):alert(e.message)},function(e){})}var p=a.server().userId;s(),t.add=function(e,a,n){$("."+n).dialog(),t.parentId=e,t.name=a},t.signsave=function(e){a.server().signsave({name:e,parentId:t.parentId,createUser:p,isFinishedTime:t.isFinishedTime?1:0,isReleaseTask:t.isReleaseTask?1:0},function(e){!0===e.result?(alert(e.message),t.isFinishedTime=!1,t.isReleaseTask=!1,t.sonsignname="",s(),t.$apply()):alert(e.message)},function(e){})},t.edit=function(e,a){$("."+a).dialog(),t.editid=e,r(e)},t.signeditparent=function(e){var a=t.isFinishedTime?1:0,n=t.isReleaseTask?1:0,o=p;l(e,t.parenteditsignname,o,a,n)},t.signeditsave=function(e){var a=t.isFinishedTime?1:0,n=t.isReleaseTask?1:0,o=p;c(t.sonid,t.parenteditsignname,e,o,a,n)},t.editson=function(e,a,n,o){$("."+o).dialog(),t.editid=e,t.sonid=n,t.parentname=a,r(n)},t.delete=function(e){confirm("确定删除?",function(){d(e)})}}]).controller("databasicprocessCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().processdatalist({},function(e){!0===e.result?(t.processlist=e.data,t.$apply()):alert(e.message)},function(e){})}function r(e){a.server().processdatainit({userId:c,nodeTypeId:e},function(e){if(!0===e.result){if(t.nodes=e.data.nodes,0==t.nodes.length)t.newJson.push({type:1,id:"",exminusers:[{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""}]});else{for(var a=0;a<t.nodes.length;a++){t.newJson.push({type:t.nodes[a].type,id:t.nodes[a].id,exminusers:[{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""}]});for(var n=0;n<t.nodes[a].exminList.length;n++)t.newJson[a].exminusers[n]={id:t.nodes[a].exminList[n].id,exminUserId:t.nodes[a].exminList[n].user_id,username:t.nodes[a].exminList[n].realname}}console.log(t.newJson)}t.$apply()}else alert(e.message)},function(e){})}function l(e){a.server().searchlist({searchKeys:e},function(e){!0===e.result?(t.searchnamelist=e.data.rows,t.$apply()):alert(e.message)},function(e){})}var c=a.server().userId;s(),t.editprocess=function(e,a,n){$("."+e).dialog(),t.processName=n,t.nodetypeId=a,r(a)},t.newJson=[],t.text="",t.ulshow=function(e,a,n,o){var i=$(".dialog-jie").scrollLeft(),s=$(".dialog-jie").scrollTop(),r=$(".dialog-cont").offset().left,c=$(".dialog-cont").offset().top,d=$("."+a+n).offset().left,p=$("."+a+n).offset().top;$(".ulshow").show(),$(".ulshow").css({left:d-r+i-15+"px",top:p-c+s-38+"px"}),l(""),t.text=a,t.idx=n,t.newJson[t.idx].id=e,t.userindx=o},t.ulcancel=function(e,t){$(".ulshow").hide(500)},t.serachsomthing=function(e){l(e)};t.getname=function(e,a){$("."+t.text+t.idx).val(a),console.log(t.newJson),t.newJson[t.idx].exminusers[t.userindx].username=a,t.newJson[t.idx].exminusers[t.userindx].exminUserId=e,console.log(t.newJson)},t.clearData=function(){$("."+t.text+t.idx).val()||(t.newJson[t.idx].exminusers[t.userindx].exminUserId="",console.log(t.newJson))},t.pushNewProcess=function(){t.newJson.push({type:1,id:"",exminusers:[{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""},{id:"",exminUserId:"",username:""}]}),console.log(t.newJson)},t.updatesave=function(){a.server().updatasavedata({userId:c,nodetypeId:t.nodetypeId,saveJson:JSON.stringify(t.newJson)},function(e){!0===e.result?(alert(e.message,function(){$(".updateprocess").hide(),t.newJson=[]}),t.$apply()):(alert(e.message,function(){t.newJson=[]}),t.$apply())},function(e){})},t.cancelsave=function(){s(),t.newJson=[]},t.deleteProcess=function(e,n){n?confirm("确定删除节点？",function(){a.server().deleteProcessData({ids:n},function(a){a.result,alert(a.message,function(){r(e),t.newJson=[]}),t.$apply()},function(e){})}):(t.newJson.pop(),console.log(t.newJson))}}]).controller("propertydeleteCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){t.projectId=n.params.projectid}]).controller("propertylinkCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){t.projectId=n.params.projectid}]).controller("propertyrebuildCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){t.projectId=n.params.projectid}]).controller("datalistCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().zjcountqueryCountDatado({projectId:t.projectId,exportType:0,type:3,startTime:t.starttime||"",endTime:t.endtime||"",schemaId:t.scheId||"",pageNo:t.conf.currentPage||1,pageSize:t.conf.itemPageLimit||10},function(e){if(!0===e.result){console.log(e.data);var a=[],n=[],o=[];t.valueArr2=[],t.columnar=e.data.columnar,t.signCountList=e.data.page.rows,t.conf.total=Math.ceil(e.data.page.total/e.data.page.pageSize),t.conf.counts=e.data.page.total,t.$broadcast("categoryLoaded"),t.leftarr=e.data.countMap,t.leftarr&&t.leftarr.forEach(function(e,n){a[n]={name:t.leftarr[n].name,value:t.leftarr[n].scale}}),t.columnar&&t.columnar.forEach(function(e,a){n.push(t.columnar[a].name),o.push(t.columnar[a].number),t.valueArr2[a]={name:t.columnar[a].name,value:t.columnar[a].number}}),console.log(t.valueArr2),r(a),l(n,o),t.$apply()}else alert(e.message)},function(e){})}function r(e){echarts.init(document.getElementById("main")).setOption({series:[{name:"访问来源",type:"pie",radius:"55%",data:e}]}),t.salesControlArr=e}function l(e,t){echarts.init(document.getElementById("main2")).setOption({xAxis:{data:e},yAxis:[{type:"value",name:"",min:0,max:600,interval:100,axisLabel:{formatter:"{value} "}}],tooltip:{},series:[{name:"访问来源",type:"bar",data:t}]})}var c=setInterval(function(){$(".l-nav>li").length>0&&($(".l-nav>li").eq(11).addClass("cur"),clearInterval(c))},10);t.projectId=n.params.projectid,t.imgHost=a.server().imgHost,t.host=a.server().host,t.starttime="",t.endtime="",t.mychange=function(e,a,n){laydate.render({elem:"."+e,format:"yyyy-MM-dd",show:!0,closeStop:"."+a,done:function(e){0==n?(t.starttime=e,s()):1==n&&(t.endtime=e,s())}})},t.conf={total:10,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit",function(e){s()}),t.exportLink=t.host+"count/queryCountData.do?projectId="+t.projectId+"&startTime="+(t.starttime||"")+"&endTime="+(t.endtime||"")+"&type=3&exportType=1&schemaId="+(t.scheId||"")+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit,console.log("kl"+t.exportLink),a.server().zjcountfindRoomTypesdo({projectId:t.projectId},function(e){!0===e.result?(t.propertyList=e.data.types,t.$apply(t.propertyList)):alert(e.message)}),t.changeData=function(e,t){1==t&&s()}}]).controller("dataFinanceCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){echarts.init(document.getElementById("main")).setOption({series:[{name:"访问来源",type:"pie",radius:"55%",data:e}]}),t.salesControlArr=e}function r(e,n){var o=[];a.server().financeDataList({projectId:t.projectId,startTime:e||"",endTime:n||"",exportType:0,schId:t.scheId||""},function(e){!0===e.result?(t.rightarr=e.data.signCountList,t.leftarr=e.data.countMap,t.leftarr&&t.leftarr.forEach(function(e,a){o[a]={name:t.leftarr[a].name,value:t.leftarr[a].percentage}}),s(o),t.$apply()):alert(e.message)},function(e){})}t.projectId=n.params.projectid,t.imgHost=a.server().imgHost,t.host=a.server().host,a.server().zjcountfindRoomTypesdo({projectId:t.projectId},function(e){!0===e.result?(t.propertyList=e.data.types,t.$apply(t.propertyList)):alert(e.message)}),t.changeData=function(e,t){1==t&&r()},t.mychange=function(e,a,n){laydate.render({elem:"."+e,format:"yyyy-MM-dd",show:!0,closeStop:"."+a,done:function(e){0==n?(t.starttime=e,r(t.starttime,t.endtime,t.scheId)):1==n?(t.endtime=e,r(t.starttime,t.endtime,t.scheId)):2==n?(t.followStartTime=e,otherSquareMeterData(t.followStartTime,t.followEndTime,t.scheId2)):3==n?(t.followEndTime=e,otherSquareMeterData(t.followStartTime,t.followEndTime,t.scheId2)):4==n?(t.noSignStartTime=e,r(t.noSignStartTime,t.noSignEndTime)):5==n&&(t.noSignEndTime=e,r(t.noSignStartTime,t.noSignEndTime))}})},r(),t.exportLink=t.host+"count/queryFincialDataList.do?projectId="+t.projectId+"&startTime="+(t.starttime||"")+"&endTime="+(t.endtime||"")+"&schId="+(t.scheId||"")+"&exportType=1"}]).controller("dataOtherCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e,n,o){a.server().otherHousePropertyDataList({projectId:t.projectId,startTime:e,endTime:n,exportType:0,schemaId:o||""},function(e){if(!0===e.result){t.otherHouseCountMap=e.data.fanShaped,t.otherHouseCountList=e.data.roomList;var a=[];a=[{name:"有房产证数量",value:t.otherHouseCountMap.haveCount},{name:"无房产证数量",value:t.otherHouseCountMap.notHaveCount}],r(a),t.$apply()}else alert(e.message)},function(e){})}function r(e){echarts.init(document.getElementById("main")).setOption({series:[{name:"访问来源",type:"pie",radius:"55%",data:e}]}),t.salesControlArr=t.otherHouseCountMap}function l(e,n,o){a.server().otherSquareMeterDataList({projectId:t.projectId,startTime:e,endTime:n,exportType:0,schemaId:o||""},function(e){if(!0===e.result){t.otherSquareCountMap=e.data.fanShaped,t.otherSquareCountList=e.data.squareMeterList;var a=[];a=[{name:"小于480百分比",value:t.otherSquareCountMap.lessThanPercentage},{name:"大于480百分比",value:t.otherSquareCountMap.greaterThanPercentage}],c(a),t.$apply()}else alert(e.message)},function(e){})}function c(e){echarts.init(document.getElementById("main2")).setOption({series:[{name:"访问来源",type:"pie",radius:"55%",data:e}]}),t.otherSquareArr=e}t.projectId=n.params.projectid,t.imgHost=a.server().imgHost,t.starttime="",t.endtime="",t.followStartTime="",t.followEndTime="",t.noSignStartTime="",t.noSignEndTime="",t.mychange=function(e,a,n){laydate.render({elem:"."+e,format:"yyyy-MM-dd",show:!0,closeStop:"."+a,done:function(e){0==n?(t.starttime=e,s(t.starttime,t.endtime,t.scheId)):1==n?(t.endtime=e,s(t.starttime,t.endtime,t.scheId)):2==n?(t.followStartTime=e,l(t.followStartTime,t.followEndTime,t.scheId2)):3==n?(t.followEndTime=e,l(t.followStartTime,t.followEndTime,t.scheId2)):4==n?(t.noSignStartTime=e,s(t.noSignStartTime,t.noSignEndTime)):5==n&&(t.noSignEndTime=e,s(t.noSignStartTime,t.noSignEndTime))}})},a.server().zjroomsearchForConditiondo({projectId:t.projectId},function(e){!0===e.result?(t.propertyList=e.data,t.$apply()):alert(e.message)}),t.changeData=function(e){1==e?s(t.starttime,t.endtime,t.scheId):2==e&&(l(t.followStartTime,t.followEndTime,t.scheId2),console.log(t.scheId2))},s("","",t.scheId||""),t.exportLink="count/otherHousePropertyCount.do?projectId="+t.projectId+"&startTime="+t.starttime+"&endTime="+t.endtime+"&exportType=1"+(t.scheId?"&schemaId="+t.scheId:""),console.log(t.exportLink),t.exportFollowLink="count/otherSquareMeter.do?projectId="+t.projectId+"&startTime="+t.followStartTime+"&endTime="+t.followEndTime+"&exportType=1"+(t.scheId2?"&schemaId="+t.scheId2:""),console.log(t.imgHost+t.exportFollowLink),l("","","")}]).controller("dataSurveyCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().zjcountqueryCountDatado({projectId:t.projectId,exportType:0,type:3,startTime:t.starttime||"",endTime:t.endtime||"",schemaId:t.scheId||"",pageNo:t.conf.currentPage||1,pageSize:t.conf.itemPageLimit||10},function(e){if(!0===e.result){console.log(e.data);var a=[],n=[],o=[];t.valueArr2=[],t.columnar=e.data.columnar,t.signCountList=e.data.page.rows,t.conf.total=Math.ceil(e.data.page.total/e.data.page.pageSize),t.conf.counts=e.data.page.total,t.$broadcast("categoryLoaded"),t.leftarr=e.data.countMap,t.leftarr&&t.leftarr.forEach(function(e,n){a[n]={name:t.leftarr[n].name,value:t.leftarr[n].scale}}),t.columnar&&t.columnar.forEach(function(e,a){n.push(t.columnar[a].name),o.push(t.columnar[a].number),t.valueArr2[a]={name:t.columnar[a].name,value:t.columnar[a].number}}),r(a),l(n,o),t.$apply()}else alert(e.message)},function(e){})}function r(e){echarts.init(document.getElementById("main")).setOption({series:[{name:"访问来源",type:"pie",radius:"55%",data:e}]}),t.salesControlArr=e}function l(e,t){echarts.init(document.getElementById("main2")).setOption({xAxis:{data:e},tooltip:{},yAxis:[{type:"value",name:"",min:0,max:600,interval:100,axisLabel:{formatter:"{value} "}}],series:[{name:"访问来源",type:"bar",data:t}]})}t.projectId=n.params.projectid,t.imgHost=a.server().imgHost,t.host=a.server().host,t.starttime="",t.endtime="",t.mychange=function(e,a,n){laydate.render({elem:"."+e,format:"yyyy-MM-dd",show:!0,closeStop:"."+a,done:function(e){0==n?(t.starttime=e,s()):1==n&&(t.endtime=e,s())}})},t.conf={total:10,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit",function(e){s()}),t.exportLink=t.host+"count/queryCountData.do?projectId="+t.projectId+"&startTime="+(t.starttime||"")+"&endTime="+(t.endtime||"")+"&type=3&exportType=1&schemaId="+(t.scheId||"")+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit,console.log(t.exportLink),a.server().zjcountfindRoomTypesdo({projectId:t.projectId},function(e){!0===e.result?(t.propertyList=e.data.types,t.$apply(t.propertyList)):alert(e.message)}),t.changeData=function(e,t){1==t&&s()}}]).controller("wuyeyijiaoCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().zjcountqueryCountDatado({projectId:t.projectId,exportType:0,type:3,startTime:t.starttime||"",endTime:t.endtime||"",schemaId:t.scheId||"",pageNo:t.conf.currentPage||1,pageSize:t.conf.itemPageLimit||10},function(e){if(!0===e.result){console.log(e.data);var a=[],n=[],o=[];t.valueArr2=[],t.columnar=e.data.columnar,t.signCountList=e.data.page.rows,t.conf.total=Math.ceil(e.data.page.total/e.data.page.pageSize),t.conf.counts=e.data.page.total,t.$broadcast("categoryLoaded"),t.leftarr=e.data.countMap,t.leftarr&&t.leftarr.forEach(function(e,n){a[n]={name:t.leftarr[n].name,value:t.leftarr[n].scale}}),t.columnar&&t.columnar.forEach(function(e,a){n.push(t.columnar[a].name),o.push(t.columnar[a].number),t.valueArr2[a]={name:t.columnar[a].name,value:t.columnar[a].number}}),r(a),l(n,o),t.$apply()}else alert(e.message)},function(e){})}function r(e){echarts.init(document.getElementById("main")).setOption({series:[{name:"访问来源",type:"pie",radius:"55%",data:e}]}),t.salesControlArr=e}function l(e,t){echarts.init(document.getElementById("main2")).setOption({xAxis:{data:e},tooltip:{},yAxis:[{type:"value",name:"",min:0,max:600,interval:100,axisLabel:{formatter:"{value} "}}],series:[{name:"访问来源",type:"bar",data:t}]})}t.projectId=n.params.projectid,t.imgHost=a.server().imgHost,t.host=a.server().host,t.starttime="",t.endtime="",t.mychange=function(e,a,n){laydate.render({elem:"."+e,format:"yyyy-MM-dd",show:!0,closeStop:"."+a,done:function(e){0==n?(t.starttime=e,s()):1==n&&(t.endtime=e,s())}})},t.conf={total:10,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit",function(e){s()}),t.exportLink=t.host+"count/queryCountData.do?projectId="+t.projectId+"&startTime="+(t.starttime||"")+"&endTime="+(t.endtime||"")+"&type=3&exportType=1&schemaId="+(t.scheId||"")+"&pageNo="+t.conf.currentPage+"&pageSize="+t.conf.itemPageLimit,a.server().zjcountfindRoomTypesdo({projectId:t.projectId},function(e){!0===e.result?(t.propertyList=e.data.types,t.$apply(t.propertyList)):alert(e.message)}),t.changeData=function(e,t){1==t&&s()}}]).controller("dataFileCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){if(e&&!(e.length<=0)){for(var t=0;t<e.length;t++)e[t].status=!1;return e}}t.projectId=n.params.projectid,t.imgHost=a.server().imgHost,t.host=a.server().host,t.arrs=[{name:"还建类型统计"},{name:"补偿项目条件"},{name:"补偿类型条件"},{name:"签约阶段条件"}],function(){a.server().zjcountquerySearchCriteriado({},function(e){e.result?(t.rebuildTypeList=e.data.rebuildTypeList,s(t.rebuildTypeList),t.compensateProjectList=e.data.compensateProjectList,s(t.compensateProjectList),t.compensateTypeList=e.data.compensateTypeList,s(t.compensateTypeList),t.orderSignList=e.data.orderSignList,s(t.orderSignList),t.$apply()):alert(e.message)})}(),t.extend=function(){if(t.compensateProjecId=[],t.signId=[],t.zhanshimeiyou=[],t.compensateTypeId=[],t.compensateTypeSublevelId=[],t.compensateTypeList&&t.compensateTypeList.length>=0)for(var e=0;e<t.compensateTypeList.length;e++)t.compensateTypeList[e].status&&(t.compensateTypeList[e].parentId?t.compensateTypeSublevelId.push(t.compensateTypeList[e].id):t.compensateTypeId.push(t.compensateTypeList[e].id));if(t.compensateProjectList&&t.compensateProjectList.length>=0)for(var e=0;e<t.compensateProjectList.length;e++)t.compensateProjectList[e].status&&t.compensateProjecId.push(t.compensateProjectList[e].id);if(t.orderSignList&&t.orderSignList.length>=0)for(var e=0;e<t.orderSignList.length;e++)t.orderSignList[e].status&&t.signId.push(t.orderSignList[e].id);if(t.rebuildTypeList&&t.rebuildTypeList.length>=0)for(var e=0;e<t.rebuildTypeList.length;e++)t.rebuildTypeList[e].status&&t.zhanshimeiyou.push(t.rebuildTypeList[e].id);if(0==t.compensateProjecId.length&&0==t.signId.length&&0==t.zhanshimeiyou.length&&0==t.compensateTypeId.length&&0==t.compensateTypeSublevelId.length)return void alert("您未勾选任何条件！");t.link=t.host+"count/createReportForms.do?projectId="+t.projectId+"&signId="+(t.signId.toString()||"")+"&compensateProjecId="+(t.compensateProjecId.toString()||"")+"&compensateTypeId="+(t.compensateTypeId.toString()||"")+"&compensateTypeSublevelId="+(t.compensateTypeSublevelId.toString()||""),console.log(t.link),window.open(t.link)}}]).controller("knowledgeCtrl",["$http","$scope","server","$state","dict","$rootScope","$sce",function(e,t,a,n,o,i,s){function r(){t.targetname="",t.targetlink="",t.targetcontent="",t.fileName="",t.filePath="",t.positionname="",t.positionlink="",t.positioncontent="",t.thoughtname="",t.thoughtlink="",t.thoughtcontent="",t.telephone=""}function l(e,n,o,i,s,r,l){a.server().addthoughtdata({createUser:y,status:e,url:n,title:o,content:i,imgUrl:s,fileName:r,sort:l},function(a){!0===a.result?(console.log(a),alert(a.message,function(){1==e?c():2==e?d():3==e&&p(),$(".dialog").hide()}),t.$apply()):alert(a.message)},function(e){})}function c(){a.server().thoughtlist({pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit},function(e){!0===e.result?(t.thoughtlist=e.data.rows,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function d(){a.server().goallist({pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit},function(e){!0===e.result?(t.goallist=e.data.rows,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function p(){a.server().positionlist({pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit},function(e){!0===e.result?(t.positionlist=e.data.rows,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function u(){a.server().tellist({pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit},function(e){!0===e.result?(t.tellist=e.data.rows,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function m(e,n,o,i){a.server().watchdata({id:e},function(e){!0===e.result?(1==n?(t.watchthoughtname=e.data.title,t.watchthoughtlink=e.data.url,t.wahtchthoughtcontent=e.data.content,t.watchthoughtsort=e.data.sort):2==n?(t.watchtargetname=e.data.title,t.watchtargetlink=e.data.url,t.watchtargetcontent=e.data.content,t.watchgoalsort=e.data.sort,t.watchtargeturl=e.data.basePath+e.data.imgUrl):3==n?(t.watchpositionname=e.data.title,t.watchpositionlink=e.data.url,t.watchpositioncontent=e.data.content,t.watchpositionsort=e.data.sort,t.watchpositionurl=e.data.basePath+e.data.imgUrl):4==n&&(t.watchtelephone=e.data.mobile),t.$apply()):alert(e.message)},function(e){})}function f(e,n,o,i,s,r,l,m,f){a.server().editsavedata({updateUser:y,status:e,mobile:n,url:o,title:i,content:s,id:r,imgUrl:l,fileName:m,sort:f},function(a){!0===a.result?(alert(a.message,function(){1==e?c():2==e?(d(),t.filePath="",t.filename=""):3==e?(p(),t.filePath="",t.filename=""):4==e&&u(),1!=f&&2!=f&&3!=f?t.editlist.splice(t.editlist.indexOf(f),1):t.editlist=[{sort:1,name:"置顶1"},{sort:2,name:"置顶2"},{sort:3,name:"置顶3"}]}),t.$apply()):alert(a.message)},function(e){})}t.clearData=function(){r(),t.goalsort=0,t.positionsort=0,t.thoughtsort=0},a.server().zjcolumnqueryColumndo({},function(e){e.result&&(t.indexwordarr=e.data,t.indexwordarr.forEach(function(e,a){1==e.columnNo&&(t.brandintroduced=e.name),2==e.columnNo&&(t.brandintrodjian=e.name),3==e.columnNo&&(t.brandintrodyu=e.name),4==e.columnNo&&(t.brandintrodxiangmu=e.name)}))},function(e){});var g=setInterval(function(){$(".l-nav>li").length>0&&($(".l-nav>li").eq(12).addClass("cur"),clearInterval(g))},10);t.hostname=a.server().imgHost;var y=a.server().userId;t.thoughtsort=0,t.goalsort=0,t.positionsort=0,t.config={
toolbars:[["anchor","undo","redo","bold","indent","snapscreen","italic","underline","strikethrough","subscript","fontborder","superscript","formatmatch","source","blockquote","pasteplain","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","deletecaption","inserttitle","mergecells","deletetable","cleardoc","insertparagraphbeforetable","insertcode","fontfamily","fontsize","paragraph","simpleupload","edittable","edittd","link","emotion","spechars","searchreplace","map","gmap","insertvideo","help","justifyleft","justifyright","justifycenter","justifyjustify","forecolor","backcolor","insertorderedlist","insertunorderedlist","fullscreen","directionalityltr","directionalityrtl","rowspacingtop","rowspacingbottom","pagebreak","insertframe","imagenone","imageleft","imageright","attachment","imagecenter","wordimage","lineheight","edittip ","customstyle","autotypeset","webapp","touppercase","tolowercase","background","template","scrawl","music","inserttable","drafts","charts"]],autoClearinitialContent:!0,wordCount:!1,elementPathEnabled:!1,initialFrameWidth:"100%",initialFrameHeight:200},t.addannex=function(a){console.log(a);var n=new FormData,o=a[0];t.filename=o.name,n.append("multipartFile",o),e({method:"POST",url:t.hostname+"attachment/fielUpload.do",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(e){t.data=e.data.data,console.log(t.data),t.fileName=t.data.fileName,t.filePath=t.data.filePath,t.size=t.data.size},function(e){alert(e)})},t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+title",function(e){}),c(),d(),p(),u(),t.addthought=function(e,a){l(e,t.thoughtlink,t.thoughtname,a,"","",t.thoughtsort)},t.targetsave=function(e,a,n,o){l(e,t.targetlink,t.targetname,a,n,o,t.goalsort)},t.positionsave=function(e,a,n,o){l(e,t.positionlink,t.positionname,a,n,o,t.positionsort)},t.addtelsave=function(e){a.server().addCustomerServiceHotline({createUser:y,status:e,mobile:t.telephone},function(e){!0===e.result?(alert(e.message,function(){u(),t.telephone=""}),t.$apply()):(alert(e.message),t.telephone="")},function(e){})},t.watchthought=function(e,t){$("."+t).dialog(),m(e,1,"","")},t.watchtarget=function(e,t,a,n){$("."+t).dialog(),m(e,2,a,n)},t.watchposition=function(e,t,a,n){$("."+t).dialog(),m(e,3,a,n)},t.watchtel=function(e,t){$("."+t).dialog(),m(e,4,"","")},t.editthought=function(e,a,n,o,i,s){t.editthoughtname=a,t.editthoughtlink=n,t.editthoughtcontent=o,t.editthoughtsort=i,$("."+s).dialog(),t.thoughtid=e},t.edittarget=function(e,a,n,o,i,s,r,l){t.edittargetname=a,t.edittargetlink=n,t.edittargetcontent=o,t.edittargeturl=r,t.edittargetFileName=s,t.editgoalsort=i,$("."+l).dialog(),t.targetid=e},t.editposition=function(e,a,n,o,i,s,r,l){t.editpositionname=a,t.editpositionlink=n,t.editpositioncontent=o,t.editpositionurl=r,t.editpositionFileName=s,t.editpositionsort=i,$("."+l).dialog(),t.positionid=e},t.edittel=function(e,a,n){t.edittelephone=a,$("."+n).dialog(),t.telid=e},t.editthoughtsave=function(){f(1,"",t.editthoughtlink,t.editthoughtname,t.editthoughtcontent,t.thoughtid,"","",t.editthoughtsort)},t.edittargetsave=function(e,a){f(2,"",t.edittargetlink,t.edittargetname,t.edittargetcontent,t.targetid,e,a,t.editgoalsort)},t.editpositionsave=function(e,a){f(3,"",t.editpositionlink,t.editpositionname,t.editpositioncontent,t.positionid,e,a,t.editpositionsort)},t.edittelsave=function(){f(4,t.edittelephone,"","","",t.telid,"","","")},t.deletedata=function(e,n){confirm("确定删除？",function(){a.server().deletelist({id:n,userId:y},function(a){!0===a.result?(alert(a.message,function(){1==e?c():2==e?d():3==e?p():4==e&&u()}),t.$apply()):alert(a.message)},function(e){})})},t.cancel=function(e){1!=e&&2!=e&&3!=e&&t.editlist.splice(t.editlist.indexOf(e),1),r()}}]).controller("newsListCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){a.server().newslistdata({pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,searchKeys:e||""},function(e){!0===e.result?(t.list=e.data.rows,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function r(){t.filePath="",t.filename="",t.newname="",t.newcontent="",t.newsort=0}t.hostname=a.server().imgHost;var l=a.server().userId;t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+title+searchKeys",function(e){s(t.searchKeys)}),s(""),t.config={toolbars:[["anchor","undo","redo","bold","indent","snapscreen","italic","underline","strikethrough","subscript","fontborder","superscript","formatmatch","source","blockquote","pasteplain","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","deletecaption","inserttitle","mergecells","deletetable","cleardoc","insertparagraphbeforetable","insertcode","fontfamily","fontsize","paragraph","simpleupload","edittable","edittd","link","emotion","spechars","searchreplace","map","gmap","insertvideo","help","justifyleft","justifyright","justifycenter","justifyjustify","forecolor","backcolor","insertorderedlist","insertunorderedlist","fullscreen","directionalityltr","directionalityrtl","rowspacingtop","rowspacingbottom","pagebreak","insertframe","imagenone","imageleft","imageright","attachment","imagecenter","wordimage","lineheight","edittip ","customstyle","autotypeset","webapp","touppercase","tolowercase","background","template","scrawl","music","inserttable","drafts","charts"]],autoClearinitialContent:!0,wordCount:!1,elementPathEnabled:!1,initialFrameWidth:"100%",initialFrameHeight:200},t.watch=function(e,a,n,o,i){$("."+e).dialog(),t.name=a,t.content=n,t.sort=i,t.watchfile=o},t.newsort=0,t.add=function(e){$("."+e).dialog()},t.addannex=function(a){var n=new FormData,o=a[0];t.filename=o.name,n.append("multipartFile",o),e({method:"POST",url:t.hostname+"attachment/fielUpload.do",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(e){t.data=e.data.data,console.log(t.data),t.fileName=t.data.fileName,t.filePath=t.data.filePath,t.size=t.data.size},function(e){alert(e)})},t.addnews=function(e,n){a.server().addnewsdata({createUser:l,name:t.newname,content:t.newcontent,imgUrl:e,fileName:n,sort:t.newsort},function(e){!0===e.result?(alert(e.message,function(){s(""),r(),$(".adddata").hide()}),t.$apply()):alert(e.message,function(){r()})},function(e){alert(data.message,function(){r()})})},t.edit=function(e,a,n,o,i,s,r){$("."+a).dialog(),t.editname=n,t.editcontent=o,t.editFilePath=i,t.editFileName=s,t.editsort=r,t.editid=e},t.editsave=function(e,n,o){a.server().addeditdata({id:e,updateUser:l,name:t.editname,content:t.editcontent,imgUrl:n,fileName:o,sort:t.editsort},function(e){!0===e.result?(alert(e.message,function(){r(),s(""),console.log(t.sortlist)}),t.$apply()):alert(e.message)},function(e){})},t.cancel=function(e){1!=e&&2!=e&&3!=e&&t.editlist.splice(t.editlist.indexOf(e),1),r(),console.log(t.sortlist)},t.delete=function(e){confirm("确认删除？",function(){a.server().deletenews({id:e,userId:l},function(e){!0===e.result?(alert(e.message,function(){s("")}),t.$apply()):alert(e.message)},function(e){})})}}]).controller("columnadminCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){a.server().zjcolumnlistdo({pageNo:t.conf.currentPage||1,pageSize:t.conf.itemPageLimit||10},function(e){!0===e.result?(t.list=e.data.rows,console.log(e.data),t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)})}t.hostname=a.server().imgHost;var r=a.server().userId;t.no="-",t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+title+searchKeys",function(e){s(t.searchKeys)}),t.edit=function(e){t.edittelephone=t.list[e].name,t.addid=t.list[e].id,$(".editfour").dialog()},t.edittelephoneflag=!1,t.blurs=function(){t.edittelephone?t.edittelephoneflag=!1:t.edittelephoneflag=!0},t.edittelsave=function(){if(!t.edittelephone)return void(t.edittelephoneflag=!0);a.server().zjcolumnupdateSavedo({id:t.addid,name:t.edittelephone,updateUser:r},function(e){!0===e.result?alert(e.message,function(){s(t.searchKeys),$(".editfour").hide(200)}):alert(e.message)})}}]).controller("knowledgeProjectCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){a.server().projectListData({pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,searchKeys:e||""},function(e){!0===e.result?(t.projectlist=e.data.rows,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function r(e){a.server().searchcontactname({searchKeys:e},function(e){!0===e.result?(t.searchlist=e.data,t.$apply()):alert(e.message)},function(e){})}t.hostname=a.server().imgHost;var l=a.server().userId;t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+title+searchKeys",function(e){s(t.searchKeys)}),s(""),t.config={toolbars:[["anchor","undo","redo","bold","indent","snapscreen","italic","underline","strikethrough","subscript","fontborder","superscript","formatmatch","source","blockquote","pasteplain","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","deletecaption","inserttitle","mergecells","deletetable","cleardoc","insertparagraphbeforetable","insertcode","fontfamily","fontsize","paragraph","simpleupload","edittable","edittd","link","emotion","spechars","searchreplace","map","gmap","insertvideo","help","justifyleft","justifyright","justifycenter","justifyjustify","forecolor","backcolor","insertorderedlist","insertunorderedlist","fullscreen","directionalityltr","directionalityrtl","rowspacingtop","rowspacingbottom","pagebreak","insertframe","imagenone","imageleft","imageright","attachment","imagecenter","wordimage","lineheight","edittip ","customstyle","autotypeset","webapp","touppercase","tolowercase","background","template","scrawl","music","inserttable","drafts","charts"]],autoClearinitialContent:!0,wordCount:!1,elementPathEnabled:!1,initialFrameWidth:"100%",initialFrameHeight:200},t.watch=function(e,a,n,o,i,s,r,l){$("."+e).dialog(),t.projectname=a,t.contactname=n,t.projectcontent=o,t.sort=l,t.imgUrl=s,t.basePath=i},t.sortlist=[{sort:0,name:"默认排序"},{sort:1,name:"置顶1"},{sort:2,name:"置顶2"},{sort:3,name:"置顶3"}],t.editlist=[{sort:1,name:"置顶1"},{sort:2,name:"置顶2"},{sort:3,name:"置顶3"}],t.newsort=0,t.add=function(e){$("."+e).dialog()},t.addannex=function(a){var n=new FormData,o=a[0];t.filename=o.name,n.append("multipartFile",o),e({method:"POST",url:t.hostname+"attachment/fielUpload.do",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(e){t.data=e.data.data,console.log(t.data),t.filename=t.data.fileName,t.filePath=t.data.filePath,t.size=t.data.size},function(e){alert(e)})},t.ulshow=function(e){$(".ulshow").show(500),r("")},t.ulcancel=function(){$(".ulshow").hide(500)},t.serachsomthing=function(e){r(e)},t.getname=function(e,a,n){"new"==n?t.newcontactname=a:"edit"==n&&(t.editcontactname=a),t.selid=e},t.addproject=function(e,n,o){function i(){t.newprojectname="",t.newprojectcontent="",t.newsort=0,t.newcontactname="",t.filePath="",t.filename=""}a.server().addprojectdata({createUser:l,projectName:t.newprojectname,projectId:e,content:t.newprojectcontent,imgUrl:n,fileName:o,dataDisplay:"",sort:t.newsort},function(e){!0===e.result?(alert(e.message,function(){s(""),i()}),t.$apply()):alert(e.message)},function(e){}),t.cancel=function(){i()}},t.edit=function(e,a,n,o,i,s,r,l,c,d){$("."+a).dialog(),t.editprojectname=n,t.editcontactname=o,t.editprojectcontent=i,1!=d&&2!=d&&3!=d?(t.editlist.push({sort:d,name:d}),t.editsort=d):t.editsort=d,t.projectid=e,t.basePath=s,t.editimgUrl=r,t.editfilename=l},t.editsave=function(e,n,o,i,r,c){a.server().editprojectdata({id:e,updateUser:l,projectName:t.editprojectname,projectId:n,content:t.editprojectcontent,imgUrl:o||r,fileName:i||c,dataDisplay:"",sort:t.editsort},function(e){!0===e.result?(alert(e.message,function(){1!=t.editsort&&2!=t.editsort&&3!=t.editsort?t.editlist.splice(t.editlist.indexOf(t.editsort),1):t.editlist=[{sort:1,name:"置顶1"},{sort:2,name:"置顶2"},{sort:3,name:"置顶3"}],s("")}),t.filename="",t.filePath="",t.$apply()):alert(e.message)},function(e){})},t.cancel=function(e){1!=e&&2!=e&&3!=e&&t.editlist.splice(t.editlist.indexOf(e),1),t.filePath="",t.filename=""},t.delete=function(e){confirm("确认删除？",function(){a.server().deleteproject({id:e,userId:l},function(e){!0===e.result?(alert(e.message,function(){s("")}),t.$apply()):alert(e.message)},function(e){})})}}]).controller("lawsregulationsCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().lawtypelist({},function(e){!0===e.result?(t.typelist=e.data.rows,t.$apply()):alert(e.message)},function(e){})}function r(e){a.server().sonlowlist({parentId:e},function(e){!0===e.result?(t.sonlist=e.data,t.$apply()):alert(e.message)},function(e){})}function l(e){a.server().addtypesave({requestJson:e},function(e){!0===e.result?(alert(e.message,function(){s(),t.typeName=""}),t.$apply()):alert(e.message)},function(e){})}function c(e){a.server().updatetypesave({requestJson:e},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})}function d(e){a.server().addlawsavedata({requestJson:e},function(e){!0===e.result?(alert(e.message,function(){r(),t.filename="",t.filePath="",t.sontitle="",t.soncontent=""}),t.$apply()):(alert(e.message),r(),t.filename="",t.filePath="",t.sontitle="",t.soncontent="")},function(e){alert(data.message),r(),t.filename="",t.filePath="",t.sontitle="",t.soncontent=""})}var p=a.server().userId;t.hostname=a.server().imgHost,t.config={toolbars:[["anchor","undo","redo","bold","indent","snapscreen","italic","underline","strikethrough","subscript","fontborder","superscript","formatmatch","source","blockquote","pasteplain","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","deletecaption","inserttitle","mergecells","deletetable","cleardoc","insertparagraphbeforetable","insertcode","fontfamily","fontsize","paragraph","simpleupload","edittable","edittd","link","emotion","spechars","searchreplace","map","gmap","insertvideo","help","justifyleft","justifyright","justifycenter","justifyjustify","forecolor","backcolor","insertorderedlist","insertunorderedlist","fullscreen","directionalityltr","directionalityrtl","rowspacingtop","rowspacingbottom","pagebreak","insertframe","imagenone","imageleft","imageright","attachment","imagecenter","wordimage","lineheight","edittip ","customstyle","autotypeset","webapp","touppercase","tolowercase","background","template","scrawl","music","inserttable","drafts","charts"]],autoClearinitialContent:!0,wordCount:!1,elementPathEnabled:!1,initialFrameWidth:"100%",initialFrameHeight:200},s(),t.showson=function(e){r(e)},t.addshow=function(e){$("."+e).dialog()},t.addparent=function(){t.requestJson={createUser:p,typeName:t.typeName},l(JSON.stringify(t.requestJson))},t.edit=function(e,a,n){console.log(e),$("."+n).dialog(),t.id=e,t.editTypename=a},t.editparent=function(e){var a={id:e,updateUser:p,typeName:t.editTypename};c(JSON.stringify(a))},t.addnewson=function(e,a){$("."+a).dialog(),t.parentid=e},t.addannex=function(a){var n=new FormData,o=a[0];t.filename=o.name,n.append("multipartFile",o),e({method:"POST",url:t.hostname+"attachment/fielUpload.do",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(e){t.data=e.data.data,console.log(t.data),t.fileName=t.data.fileName,t.filePath=t.data.filePath,t.size=t.data.size},function(e){alert(e)})},t.addson=function(e){var a={createUser:p,parentId:t.parentid,projectTitle:t.sontitle,policyContent:e,imageUrl:t.filePath?t.filePath:"",fileName:t.fileName?t.fileName:""};d(JSON.stringify(a))},t.editson=function(e,a,n,o,i,s,r){$("."+r).dialog(),t.parentid=e,t.sonid=a,t.editlawname=n,t.editlawcontent=o,t.editlawfilePath=i,t.editlawfileName=s},t.updatelawsave=function(e,n,o){var i={id:t.sonid,updateUser:p,projectTitle:t.editlawname,policyContent:t.editlawcontent,imageUrl:n,fileName:o};a.server().updatelawsavedata({requestJson:JSON.stringify(i)},function(e){!0===e.result?(alert(e.message,function(){r(t.sonid),t.fileName="",t.filePath=""}),t.$apply()):alert(e.message)},function(e){})},t.delete=function(e){confirm("确定删除?",function(){a.server().deletetypedata({id:e,userId:p},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})})},t.deleteson=function(e,n){confirm("确定删除?",function(){a.server().deletelawdata({id:n,userId:p},function(a){!0===a.result?(alert(a.message,function(){r(e)}),t.$apply()):alert(a.message)},function(e){})})},t.cancel=function(){t.filePath="",t.fileName=""}}]).controller("systemsetCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){a.server().organizationlist({pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,searchKeys:e},function(e){!0===e.result?(t.datalist=e.data.rows,t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}var r=setInterval(function(){$(".l-nav>li").length>0&&($(".l-nav>li").eq(13).addClass("cur"),clearInterval(r))},10);t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+searchKeys",function(e){s(t.searchKeys)}),s()}]).controller("peoplelistCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e,n,o){a.server().peoplelist({deptId:e,pageSize:t.conf.itemPageLimit,pageNo:t.conf.currentPage,searchKeys:n,letter:o},function(e){!0===e.result?(t.peoplelist=e.data.rows,t.total=e.data.total,t.conf.total=Math.ceil(e.data.total/e.data.pageSize),t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function r(e){a.server().watchAppraiseData({userId:e,pageNo:t.page,pageSize:t.pageSize},function(e){if(!0===e.result){var a=e.data;0==a.rows.length&&(t.pageFlag=!1),a.pageCount==t.page&&(t.pageFlag=!1);var n=!0,o=!1,i=void 0;try{for(var s,r=a.rows[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var l=s.value;t.appraiseList.push(l)}}catch(e){o=!0,i=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}t.$apply()}else alert(e.message)},function(e){})}t.deptId=n.params.deptId;var l=a.server().userId;t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.letterData=[{name:"全部",letter:0,status:!0},{name:"A",letter:"A",status:!1},{name:"B",letter:"B",status:!1},{name:"C",letter:"C",status:!1},{name:"D",letter:"D",status:!1},{name:"E",letter:"E",status:!1},{name:"F",letter:"F",status:!1},{name:"G",letter:"G",status:!1},{name:"H",letter:"H",status:!1},{name:"I",letter:"I",status:!1},{name:"J",letter:"J",status:!1},{name:"K",letter:"K",status:!1},{name:"L",letter:"L",status:!1},{name:"M",letter:"M",status:!1},{name:"N",letter:"N",status:!1},{name:"O",letter:"O",status:!1},{name:"P",letter:"P",status:!1},{name:"Q",letter:"Q",status:!1},{name:"R",letter:"R",status:!1},{name:"S",letter:"S"},{name:"T",letter:"T",status:!1},{name:"U",letter:"U"},{name:"V",letter:"V",status:!1},{name:"W",letter:"W",status:!1},{name:"X",letter:"X",status:!1},{name:"Y",letter:"Y",status:!1},{name:"Z",letter:"Z",status:!1}],t.selet=function(e,a){if(0==e&&1==a)for(var n=1;n<t.letterData.length;n++)t.letterData[n].status=!1;0!=e&&1==a&&(t.letterData[0].status=!1);for(var o=[],i=0;i<t.letterData.length;i++)1==t.letterData[i].status&&(0==t.letterData[i].letter?o=[]:o.push(t.letterData[i].letter));s(t.deptId,t.searchKeys,o.toString())},t.$watch("conf.currentPage + conf.itemPageLimit+searchKeys",function(e){s(t.deptId,t.searchKeys,"")}),s(t.deptId,"",""),t.addAppraise=function(e,a,n){$("."+e).dialog(),t.id=a,t.addRealName=n},t.addUserAppraiseData=function(e){a.server().addAppraiseData({userId:e,appraise:t.newappraise,createUser:l},function(e){!0===e.result?(alert(e.message,function(){s(t.deptId,"",""),t.newappraise=""}),t.$apply()):alert(e.message)},function(e){})},t.page=1,t.pageSize=5,t.pageFlag=!0,t.appraiseList=[],t.addPage=function(e){t.page++,r(e)},t.watchAppraise=function(e,a,n){setTimeout(function(){$("."+e).dialog()},300),t.addRealName=n,t.id=a,r(a)},t.cancel=function(){t.appraiseList=[]}}]).controller("propertyaccreditCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e,n){a.server().accreditlist({projectId:e,pageSize:t.conf.itemPageLimit,pageNo:t.conf.currentPage,searchKeys:n},function(e){if(!0===e.result){t.accreditlist=e.data.rows;for(var a=0;a<t.accreditlist.length;a++)t.accreditlist[a].status=!1;console.log(t.accreditlist),t.total=e.data.total,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)},function(e){})}function r(e){a.server().initrolelist({searchKeys:t.searchKeys,pageNo:t.conf2.currentPage||1,pageSize:t.conf2.itemPageLimit||10},function(e){if(!0===e.result){t.rolelist=e.data.rows;for(var a=0;a<t.rolelist.length;a++)for(var n=0;n<t.roleidlist.length;n++)t.rolelist[a].id===t.roleidlist[n]&&(t.rolelist[a].isFlag=!0);t.total=e.data.total,t.conf2.total=e.data.pageCount,t.conf2.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded2")}else alert(e.message)},function(e){})}var l=a.server().userId;t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.conf2={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},function(e){a.server().searchprojectName({searchKeys:e||""},function(e){!0===e.result?(t.searchlist=e.data,t.projectName=e.data[0].id,s(t.projectName,t.searchProperty),t.$apply()):alert(e.message)},function(e){})}(),t.myFunc2=function(e){s(t.projectName,t.searchProperty)},t.sellists=function(e){s(t.projectName,t.searchProperty)},t.selpeople=function(e,a){setTimeout(function(){$("."+a).dialog()},300),r(t.searchKeys),t.piliangarr=e},t.selectAllPeople=function(e){$("."+e).dialog(300),r()},t.shaixuan=function(e){r(searchKeys)},t.$watch("conf2.currentPage + conf2.itemPageLimit+searchKeys",function(e){r(t.searchKeys)}),t.$watch("conf.currentPage + conf.itemPageLimit",function(e){s(t.projectId,t.searchProperty)}),t.roleidlist=[],t.addrole=function(e,a){o.rolemultiple(t.roleidlist,t.rolelist,e,a)},t.addsel=function(){for(var e=[],n=0;n<t.accreditlist.length;n++)1==t.accreditlist[n].status&&e.push(t.accreditlist[n].id);a.server().addAllsel({createUser:l,strUserId:t.roleidlist.toString(),strRoomId:t.piliangarr.toString()},function(a){!0===a.result?(alert("保存成功",function(){s(t.projectId,t.searchProperty),t.roleidlist=[],e=[]}),t.$apply()):alert(a.message)},function(e){})},t.addAllsel=function(){for(var e=[],n=0;n<t.accreditlist.length;n++)1==t.accreditlist[n].status&&e.push(t.accreditlist[n].id);a.server().addSingelsel({projectId:t.projectName,userId:l,strUserId:t.roleidlist.toString()},function(a){!0===a.result?(alert("保存成功",function(){s(t.projectId,t.searchProperty),t.roleidlist=[],e=[],t.batchChecked=!1}),t.$apply()):alert(a.message)},function(e){})},t.cancel=function(){t.conf.total="",t.conf.counts="",t.rolelist="",t.roleidlist=[],t.searchKeys=""};t.checkAll=function(e){e?t.accreditlist.forEach(function(e,a){t.accreditlist[a].status=!0}):t.accreditlist.forEach(function(e,a){t.accreditlist[a].status=!1})},t.check=function(e,a){if(t.selectAll=!1,e){var n=0;t.accreditlist.forEach(function(e,a){t.accreditlist[a].status&&n++}),n===t.accreditlist.length&&(t.selectAll=!0)}else{var o=0;t.accreditlist.forEach(function(e,a){t.accreditlist[a].status||o++}),o===t.accreditlist.length&&(t.selectAll[a].status=!0)}},t.allotrole=function(){t.piliangarr=[],t.accreditlist.forEach(function(e,a){t.accreditlist[a].status&&t.piliangarr.push(t.accreditlist[a].id)}),t.piliangarr.length>0?(r(),$(".hchakantwo").dialog(300)):alert("请选择授权列表")}}]).controller("propertyPeopleCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(e){a.server().ppListData({searchKeys:e,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit},function(e){!0===e.result?(t.accreditlist=e.data.rows,t.accreditlist.forEach(function(e,a){t.accreditlist[a].status=!1}),t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function r(e){a.server().propertyListData({userId:e,searchKeys:t.searchKeys,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit},function(e){!0===e.result?(t.propertylist=e.data.rows,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")):alert(e.message)},function(e){})}function l(e){a.server().zjpropertyauthoritydeleteEmpowerdo({strUserId:e.toString(),userId:t.userId},function(e){!0===e.result?alert(e.message,function(){s(t.searchKeys)}):alert(e.message)})}t.userId=a.server().userId,t.conf={total:6,currentPage:1,itemPageLimit:6,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+searchKeys+propertylist",function(){t.propertylist?r(t.propertyId):s(t.searchKeys)}),s(""),t.selproperty=function(e,a){$("."+a).dialog(),t.propertyId=e,r(e)},t.cancel=function(){s("")},t.selectAll=!1,t.checkAll=function(e){e?t.accreditlist.forEach(function(e,a){t.accreditlist[a].status=!0}):t.accreditlist.forEach(function(e,a){t.accreditlist[a].status=!1})},t.check=function(e,a){if(t.selectAll=!1,e){var n=0;t.accreditlist.forEach(function(e,a){t.accreditlist[a].status&&n++}),n===t.accreditlist.length&&(t.selectAll=!0)}else{var o=0;t.accreditlist.forEach(function(e,a){t.accreditlist[a].status||o++}),o===t.accreditlist.length&&(t.selectAll[a].status=!0)}},t.allotrole=function(){t.piliangarr=[],t.accreditlist.forEach(function(e,a){t.accreditlist[a].status&&t.piliangarr.push(t.accreditlist[a].userId)}),t.piliangarr.length>0?confirm("确认批量删除吗？",function(){l(t.piliangarr)}):alert("请选择删除列表")},t.deleterole=function(e){confirm("确认删除该条吗？",function(){l(e)})}}]).controller("roleaccreditCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().roleaccreditlist({pageSize:t.conf.itemPageLimit,pageNo:t.conf.currentPage,searchKeys:t.searchKeys},function(e){if(!0===e.result){t.roleaccreditlist=e.data.rows;for(var a=0;a<t.roleaccreditlist.length;a++)t.roleaccreditlist[a].status=!1;t.total=e.data.total,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)},function(e){})}function r(e){a.server().deleterolelist({id:e},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})}var l=a.server().userId;t.conf={total:6,currentPage:1,itemPageLimit:10,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+searchKeys",function(e){s()}),s(),t.allclick=function(e,a){if(e)for(var n=0;n<t.addRootData[a].rootData.length;n++)t.addRootData[a].rootData[n].status=!0;else for(var n=0;n<t.addRootData[a].rootData.length;n++)t.addRootData[a].rootData[n].status=!1},t.singleChoose=function(e,a){if(console.log(e,a),e){for(var n=0,o=0;o<t.addRootData[a].rootData.length;o++)t.addRootData[a].rootData[o].status&&n++;n==t.addRootData[a].rootData.length?t.addRootData[a].allChoose=!0:t.addRootData[a].allChoose=!1}else t.addRootData[a].allChoose=!1};var c=function(e){return t.addRootData=[],new Promise(function(n,o){a.server().zjrolerightInitialisedo({},function(a){if(!0===a.result){t.myData=a.data,n(t.myData),t.$apply();for(var o=0;o<t.myData.length;o++)t.myData[o].class=1==t.myData[o].status,t.myData[o].titlestatus=t.myData[o].status,t.myData[o].status=!1;for(var i=0;i<t.myData.length;i++)switch(t.myData[i].type){case 1:t.addRootData[0]||(t.addRootData[0]={title:"项目",allChoose:!1,index:0,rootData:[]}),1==t.myData[i].status?t.addRootData[0].rootData.unshift(t.myData[i]):t.addRootData[0].rootData.push(t.myData[i]);break;case 2:t.addRootData[1]||(t.addRootData[1]={title:"物业管理",allChoose:!1,index:1,rootData:[]}),t.addRootData[1].rootData.push(t.myData[i]);break;case 3:t.addRootData[2]||(t.addRootData[2]={title:"物业信息",allChoose:!1,index:2,rootData:[]}),t.addRootData[2].rootData.push(t.myData[i]);break;case 4:t.addRootData[3]||(t.addRootData[3]={title:"我的工作",allChoose:!1,index:3,rootData:[]}),t.addRootData[3].rootData.push(t.myData[i]);break;case 5:t.addRootData[4]||(t.addRootData[4]={title:"物业移交",allChoose:!1,index:4,rootData:[]}),t.addRootData[4].rootData.push(t.myData[i]);break;case 7:t.addRootData[5]||(t.addRootData[5]={title:"物业拆除",allChoose:!1,index:5,rootData:[]}),t.addRootData[5].rootData.push(t.myData[i]);break;case 8:t.addRootData[6]||(t.addRootData[6]={title:"物业还建",allChoose:!1,index:6,rootData:[]}),t.addRootData[6].rootData.push(t.myData[i]);break;case 9:t.addRootData[7]||(t.addRootData[7]={title:"财务管理",allChoose:!1,index:7,rootData:[]}),t.addRootData[7].rootData.push(t.myData[i]);break;case 10:t.addRootData[8]||(t.addRootData[8]={title:"审批",allChoose:!1,index:8,rootData:[]}),t.addRootData[8].rootData.push(t.myData[i]);break;case 11:t.addRootData[9]||(t.addRootData[9]={title:"合同",allChoose:!1,index:9,rootData:[]}),t.addRootData[9].rootData.push(t.myData[i]);break;case 12:t.addRootData[10]||(t.addRootData[10]={title:"系统设置",allChoose:!1,index:10,rootData:[]}),t.addRootData[10].rootData.push(t.myData[i]);break;case 14:t.addRootData[11]||(t.addRootData[11]={title:"知识库",allChoose:!1,index:11,rootData:[]}),t.addRootData[11].rootData.push(t.myData[i]);break;case 15:t.addRootData[12]||(t.addRootData[12]={title:"数据统计",allChoose:!1,index:12,rootData:[]}),t.addRootData[12].rootData.push(t.myData[i])}t.$apply(),t.addRootData.length>0&&e&&$("."+e).dialog()}else alert(a.message)})})},d=function(e,n,o){a.server().editroleinit({id:o},function(a){if(!0===a.result){if(t.roleMap=a.data.roleMap,t.updatename=t.roleMap.name,t.updateremarks=t.roleMap.remarks,t.rightMap=a.data.rightMap,t.rightMap&&t.rightMap.length>0)for(var o=0;o<e.length;o++){e[o].status=!1;for(var i=0;i<t.rightMap.length;i++)e[o].id==t.rightMap[i]&&(e[o].status=!0)}t.$apply(),$("."+n).dialog()}else alert(a.message)})};t.addshow=function(e){c(e)},t.editbasiclist=function(e,a){t.detid=a,c().then(function(t){d(t,e,a)})},t.addsave=function(){for(var e=[],n=0;n<t.myData.length;n++)1==t.myData[n].status&&e.push(t.myData[n].id);a.server().addsaverole({name:t.rolename,remarks:t.remarks,createUser:l,rights:e.join(",")},function(e){!0===e.result?(alert(e.message,function(){s(),t.rolename="",t.remarks="";for(var e=0;e<t.progress.length;e++)t.progress[e].status=!1}),t.$apply()):alert(e.message)},function(e){})},t.updatesave=function(){for(var e=[],n=0;n<t.myData.length;n++)1==t.myData[n].status&&e.push(t.myData[n].id);a.server().updatesaverole({id:t.detid,name:t.updatename,remarks:t.updateremarks,updateUser:l,rights:e.toString()},function(e){!0===e.result?(alert(e.message,function(){s(),t.name="",t.remarks="";for(var e=0;e<t.myData.length;e++)t.myData[e].status=!1}),t.$apply()):alert(e.message)},function(e){})},t.batchselect=function(e,a){t.batchChecked=!1},t.batchAll=function(e){if(e.target.checked)for(var a=0;a<t.roleaccreditlist.length;a++)t.roleaccreditlist[a].status=!0;else for(var a=0;a<t.roleaccreditlist.length;a++)t.roleaccreditlist[a].status=!1
},t.deleterole=function(e){confirm("确认删除？",function(){r(e)})},t.deletelist=function(){confirm("确认删除这些角色？",function(){for(var e=[],a=0;a<t.roleaccreditlist.length;a++)1==t.roleaccreditlist[a].status&&e.push(t.roleaccreditlist[a].id);r(e.toString())})}}]).controller("allotroleCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().initrolelist({searchKeys:t.searchKeys,pageNo:t.conf2.currentPage,pageSize:t.conf2.itemPageLimit},function(e){if(!0===e.result){t.rolelist=e.data.rows,t.total=e.data.total;for(var a=0;a<t.rolelist.length;a++)for(var n=0;n<t.roleidlist.length;n++)t.rolelist[a].id===t.roleidlist[n]&&(t.rolelist[a].isFlag=!0);t.conf2.total=e.data.pageCount,t.conf2.counts=e.data.total,t.$broadcast("categoryLoaded2"),t.$apply()}else alert(e.message)},function(e){})}function r(){a.server().initroleuserlist({searchKeys:t.searchKeys,pageNo:t.conf.currentPage,pageSize:t.conf.itemPageLimit,roleId:t.roleid},function(e){if(!0===e.result){t.roleuserlist=e.data.rows;for(var a=0;a<t.roleuserlist.length;a++)t.roleuserlist[a].status=!1;t.total=e.data.total,t.conf.total=e.data.pageCount,t.conf.counts=e.data.total,t.$apply(),t.$broadcast("categoryLoaded")}else alert(e.message)},function(e){})}function l(e){a.server().deleteRoleUserList({id:e},function(e){!0===e.result?(alert(e.message,function(){r()}),t.$apply()):alert(e.message)},function(e){})}t.roleid=n.params.roleid;var c=a.server().userId;t.conf={total:6,currentPage:1,itemPageLimit:6,isSelectPage:!1,isLinkPage:!1},t.conf2={total:6,currentPage:1,itemPageLimit:6,isSelectPage:!1,isLinkPage:!1},t.$watch("conf.currentPage + conf.itemPageLimit+searchKeys",function(e){r()}),t.$watch("conf2.currentPage + conf2.itemPageLimit+searchKeys",function(e){s()}),t.addroleshow=function(e){$("."+e).dialog(),s()},t.roleidlist=[],t.addrole=function(e,a){o.rolemultiple(t.roleidlist,t.rolelist,e,a)},t.addAllotRole=function(){a.server().addroleuser({createUser:c,arrayId:t.roleidlist.toString(),roleId:t.roleid},function(e){!0===e.result?(alert("保存成功",function(){t.roleidlist=[],r()}),t.$apply()):alert(e.message)},function(e){})},t.cancel=function(){t.conf.total="",t.conf.counts="",r(),t.roleidlist=[]},r();t.batchselect=function(e,a){t.batchChecked=!1},t.batchAll=function(e){if(e.target.checked)for(var a=0;a<t.roleuserlist.length;a++)t.roleuserlist[a].status=!0;else for(var a=0;a<t.roleuserlist.length;a++)t.roleuserlist[a].status=!1},t.deleteUser=function(e){confirm("确定删除这个角色？",function(){l(e)})},t.deleteUserList=function(){for(var e=[],a=0;a<t.roleuserlist.length;a++)1==t.roleuserlist[a].status&&e.push(t.roleuserlist[a].id);confirm("确定删除这些角色？",function(){l(e.toString())})}}]).controller("databasicCompensationProjectCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().compensateprojectlist({},function(e){!0===e.result?(t.projectlist=e.data,t.$apply()):alert(e.message)},function(e){})}var r=a.server().userId;t.status=0,s(),t.addshow=function(e){$("."+e).dialog()},t.editprojectlist=function(e,a,n,o,i){$("."+e).dialog(),t.updatecompensateName=n,t.updateremarks=o,t.id=a,t.updateStatus=i},t.projectsave=function(){a.server().addprojectsave({compensateName:t.compensateName,createUser:r,remarks:t.remarks,type:t.status},function(e){!0===e.result?(alert(e.message,function(){s(),t.compensateName="",t.remarks=""}),t.$apply()):alert(e.message)},function(e){})},t.updateprojectsave=function(e){a.server().updateprojectsave({id:e,updateUser:r,remarks:t.updateremarks,compensateName:t.updatecompensateName,type:t.updateStatus},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})},t.deleteproject=function(e){confirm("确定删除？",function(){a.server().deleteprojectdata({id:e},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})})}}]).controller("databasicCompensationTypeCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){t.isStatus=0,t.isArea=2,t.whetherOrNot=1,t.isPicture=2,t.compensateName="",t.remarks="",t.sonName="",t.description=""}function r(){a.server().parentnodelist({},function(e){!0===e.result?(t.parentlist=e.data,t.$apply()):alert(e.message)},function(e){})}function l(e){a.server().sonnodelist({parentId:e},function(e){!0===e.result?(t.sonlist=e.data,t.$apply()):alert(e.message)},function(e){})}function c(e,n,o,i,l,c,d,p){a.server().addpjtypesave({compensateName:o,status:i,isArea:l,parentId:e,whetherOrNot:c,isPicture:d,type:n,createUser:u,remarks:p},function(e){!0===e.result?(alert(e.message,function(){s(),r()}),t.$apply()):(alert(e.message),s())},function(e){})}function d(e){a.server().editnodelist({id:e},function(e){!0===e.result?(t.list=e.data,t.updatecompensateName=t.list.compensateName,t.isupdateStatus=t.list.status,t.isupdateArea=t.list.isArea,t.updatewhetherOrNot=t.list.whetherOrNot,t.isupdatePicture=t.list.isPicture,t.updateremarks=t.list.remarks,t.$apply()):alert(e.message)},function(e){})}function p(e,n,o,i,s,l,c,d,p){a.server().updatepjtypesave({id:e,compensateName:i,status:s,isArea:l,parentId:n,whetherOrNot:c,isPicture:d,type:o,updateUser:u,remarks:p},function(e){!0===e.result?(alert(e.message,function(){r()}),t.$apply()):alert(e.message)},function(e){})}var u=a.server().userId;t.isStatus=0,t.isArea=2,t.whetherOrNot=1,t.isPicture=2,t.clearData=function(){s()},r(),t.flag=!1,t.showson=function(e){l(e)},t.addshow=function(e){$("."+e).dialog()},t.addprojectsave=function(e,t,a,n,o,i,s,r){n=n||0,c(e,t,a,n,o,i,s,r)},t.edit=function(e,a){$("."+a).dialog(),d(e),t.id=e},t.updateprojectsave=function(e,t,a,n,o,i,s,r,l){o=o||0,p(e,t,a,n,o,i,s,r,l)},t.addnewson=function(e,a){$("."+a).dialog(),t.parentid=e},t.addsonsave=function(e,t,a,n,o,i,s,r){n=n||0,c(e,t,a,n,o,i,s,r)},t.editson=function(e,n,o){$("."+o).dialog(),t.parentid=e,t.sonid=n,a.server().editnodelist({id:n},function(e){!0===e.result?(t.list=e.data,t.updatesonName=t.list.compensateName,t.isupdatesonStatus=t.list.status,t.isupdatesonArea=t.list.isArea,t.updatesonwhetherOrNot=t.list.whetherOrNot,t.isupdatesonPicture=t.list.isPicture,t.updatesonremarks=t.list.remarks,t.$apply()):alert(e.message)},function(e){})},t.delete=function(e,n){confirm("确定删除?",function(){a.server().deletedata({id:e},function(e){!0===e.result?(alert(e.message,function(){r(),""!=n&&l(n)}),t.$apply()):alert(e.message)},function(e){})})}}]).controller("singledatabasicCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){t.istype="",t.newname="",t.remarks=""}function r(){a.server().singlelist({},function(e){!0===e.result?(t.singledata=e.data,t.$apply()):alert(e.message)},function(e){})}var l=a.server().userId;t.istype="",t.newname="",t.clearData=function(){s()},r(),t.addshow=function(e){$("."+e).dialog()},t.editprojectlist=function(e,a,n,o,i){$("."+e).dialog(),t.isupdatetype=n,t.updatename=o,t.updateremarks=i,t.id=a},t.projectsave=function(){a.server().addsingledata({name:t.newname,remarks:t.remarks,type:t.istype,createUser:l},function(e){!0===e.result?(alert(e.message,function(){s(),r()}),t.$apply()):(alert(e.message),s())},function(e){})},a.server().settinginit({},function(e){!0===e.result?(t.initdata=e.data,t.$apply()):alert(e.message)},function(e){}),t.updatesave=function(e){a.server().updatesavedata({id:e,name:t.updatename,remarks:t.updateremarks,type:t.isupdatetype,updateUser:l},function(e){!0===e.result?(alert(e.message,function(){r()}),t.$apply()):alert(e.message)},function(e){})},t.delete=function(e){confirm("确定删除？",function(){a.server().deletesingledata({id:e},function(e){!0===e.result?(alert(e.message,function(){r()}),t.$apply()):alert(e.message)},function(e){})})}}]).controller("databasiccompactCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().compactdatalists({},function(e){!0===e.result?(t.list=e.data,t.$apply()):alert(e.message)},function(e){})}var r=a.server().userId;t.clearData=function(){t.templateName="",t.content=""},s(),t.editcompact=function(e,n){t.updatetemplateName="",t.updatetemplateOne="",t.updatecontent="",$("."+e).dialog(),t.id=n,a.server().editcompactdata({id:n},function(e){!0===e.result?(t.updatetemplateName=e.data.templateName,t.updatecontent=e.data.templateContent,t.updatetemplateOne=e.data.templateOne,t.$apply()):alert(e.message)},function(e){})},t.config={toolbars:[["anchor","undo","redo","bold","indent","snapscreen","italic","underline","strikethrough","subscript","fontborder","superscript","formatmatch","source","blockquote","pasteplain","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","deletecaption","inserttitle","mergecells","deletetable","cleardoc","insertparagraphbeforetable","insertcode","fontfamily","fontsize","paragraph","simpleupload","edittable","edittd","link","emotion","spechars","searchreplace","map","gmap","insertvideo","help","justifyleft","justifyright","justifycenter","justifyjustify","forecolor","backcolor","insertorderedlist","insertunorderedlist","fullscreen","directionalityltr","directionalityrtl","rowspacingtop","rowspacingbottom","pagebreak","insertframe","imagenone","imageleft","imageright","attachment","imagecenter","wordimage","lineheight","edittip ","customstyle","autotypeset","webapp","touppercase","tolowercase","background","template","scrawl","music","inserttable","drafts","charts"]],autoClearinitialContent:!0,wordCount:!1,elementPathEnabled:!1,initialFrameWidth:"100%",initialFrameHeight:200},t.addshow=function(e){t.templateName="",t.templateOne="",t.content="",$("."+e).dialog()},t.updatecompactsave=function(e,n){a.server().updatecompactdata({id:n,templateName:t.updatetemplateName,templateOne:t.updatetemplateOne,templateContent:e,updateUser:r},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})},t.projectsave=function(e){a.server().addcompactdata({templateName:t.templateName,templateContent:e,createUser:r,templateOne:t.templateOne},function(e){!0===e.result?(alert(e.message,function(){t.templateName="",t.content="",s()}),t.$apply()):(alert(e.message),t.templateName="",t.content="")},function(e){})},t.deletecompact=function(e){confirm("确定删除？",function(){a.server().deletecompactdata({id:e},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})})}}]).controller("newsDetailCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){t.newsId=n.params.newsId;var s=a.server().userId,r=a.server().loginHost;t.login=function(){document.location=r},t.imgHost=a.server().imgHost,""!=s&&a.server().zjmUserImg({userId:s},function(e){e.result?(t.nickname=e.data.nickname,t.realname=e.data.realname,t.photoUrl=e.data.photoUrl,t.$apply()):alert(e.message)}),a.server().zjcolumnqueryColumndo({},function(e){e.result&&(t.indexwordarr=e.data,t.indexwordarr.forEach(function(e,a){1==e.columnNo&&(t.brandintroduced=e.name),2==e.columnNo&&(t.brandintrodjian=e.name),3==e.columnNo&&(t.brandintrodyu=e.name),4==e.columnNo&&(t.brandintrodxiangmu=e.name)}))},function(e){}),a.server().lgcMainInfoHotline({},function(e){t.mobile=e.data[0].mobile,t.$apply()},function(){alert(errorText)}),a.server().newsDetailsInfo({id:t.newsId},function(e){e.result?t.newsList=e.data:alert(e.message),t.$apply()},function(){alert(errorText)})}]).controller("databasicRebuildCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){function s(){a.server().rebuildInitList({},function(e){!0===e.result?(t.rebuildData=e.data,t.$apply()):alert(e.message)},function(e){})}var r=a.server().userId;t.istype="",t.newname="",t.clearData=function(){t.newname="",t.remarks="",t.istype=""},s(),t.addshow=function(e){$("."+e).dialog()},t.editprojectlist=function(e,a,n,o,i){$("."+e).dialog(),t.isupdatetype=n,t.updatename=o,t.updateremarks=i,t.id=a},t.rebuildsave=function(){a.server().addRebuildData({shemaName:t.newname,remarks:t.remarks,status:t.istype,createUser:r},function(e){!0===e.result?(alert(e.message,function(){s(),t.newname="",t.remarks="",t.istype=""}),t.$apply()):(alert(e.message),t.newname="",t.remarks="",t.istype="")},function(e){})},a.server().rebuidTypeinit({},function(e){!0===e.result?(t.initdata=e.data,t.$apply()):alert(e.message)},function(e){}),t.updatesave=function(e){a.server().updateRebuildData({id:e,shemaName:t.updatename,remarks:t.updateremarks,status:t.isupdatetype,updateUser:r},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})},t.delete=function(e){confirm("确定删除？",function(){a.server().deleteRebuildData({id:e,userId:r},function(e){!0===e.result?(alert(e.message,function(){s()}),t.$apply()):alert(e.message)},function(e){})})}}]).controller("pactInfoCtrl",["$http","$scope","server","$state","dict","$rootScope",function(e,t,a,n,o,i){t.pactId=n.params.pactId,t.flag=n.params.flag,"1"==t.flag?a.server().compactdatalist({pactId:t.pactId},function(e){e.result?(t.content=e.data.content,t.$apply()):alert(e.message)}):a.server().watchPactInfoData({pactId:t.pactId},function(e){!0===e.result?(t.content=e.data.content,t.$apply()):alert(e.message)},function(e){})}]);